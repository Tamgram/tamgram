theory Visa_EMV_Low begin

// Function signature and definition of the equational theory E

builtins: xor
functions: MAC_27/2, MAC_arpc_28/2, adec/2, aenc/2, f_26/2, fst/1, h/1,
           p8_29/1, pair/2, pk/1, sign/2, snd/1, true/0, verify/3
equations:
    adec(aenc(x.1, pk(x.2)), x.2) = x.1,
    fst(<x.1, x.2>) = x.1,
    snd(<x.1, x.2>) = x.2,
    verify(sign(x.1, x.2), x.1, pk(x.2)) = true



rule (modulo E) Terminal_Bank_Network_40:
   [ Send_30( S_38, R_39, channelID_37, msg_36 ) ]
  -->
   [ Recv_31( S_38, R_39, channelID_37, msg_36 ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_Amount_Low_41:
   [ ]
  --[ Once_32( <$amount, 'Amount'> ) ]->
   [ !Value_33( $amount, 'Low' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_Amount_High_42:
   [ ]
  --[ Once_32( <$amount, 'Amount'> ) ]->
   [ !Value_33( $amount, 'High' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_ATC_44:
   [ Fr( ~ATC_43 ) ] --> [ !ATC_34( ~ATC_43 ), Out( ~ATC_43 ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Generate_SDAD_Format_Visa_45:
   [ ] --> [ !SDADFormat_35( '05', 'TC' ), !SDADFormat_35( '95', 'ARQC' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_CA_53:
   [ Fr( ~privkCA_49 ) ]
  --[ Once_32( $CA ), Role_46( $CA, 'CA' ) ]->
   [
   !LtkCA_47( $CA, ~privkCA_49 ),
   !CertCA_48( $CA,
               <<'01', $CA, pk(~privkCA_49), $CA>, 
                sign(<'01', $CA, pk(~privkCA_49), $CA>, ~privkCA_49)>
   ),
   Out( pk(~privkCA_49) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_Bank_62:
   [ Fr( ~privkBank_58 ), !LtkCA_47( $CA, ~privkCA_57 ) ]
  --[ Once_32( $Bank ), Role_46( $Bank, 'Bank' ) ]->
   [
   !LtkBank_54( $Bank, ~privkBank_58 ),
   !CertBank_55( $Bank,
                 <<'02', $Bank, pk(~privkBank_58), $CA>, 
                  sign(<'02', $Bank, pk(~privkBank_58), $CA>, ~privkCA_57)>
   ),
   !IssuingCA_56( $Bank, $CA ), Out( pk(~privkBank_58) )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_CA_67:
   [ !LtkCA_47( $CA, ~privkCA_66 ) ]
  --[ Compromise_63( $CA ) ]->
   [ Out( ~privkCA_66 ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Bank_69:
   [ !LtkBank_54( $Bank, ~privkBank_68 ) ]
  --[ Compromise_63( $Bank ) ]->
   [ Out( <$Bank, ~privkBank_68> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Card_73:
   [ !LtkCard_70( ~PAN_72, ~privkCard_71 ) ]
  --[ Compromise_63( ~PAN_72 ) ]->
   [ Out( <~PAN_72, ~privkCard_71> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Compromise_Bank_Card_ShK_76:
   [ !IssuingBank_64( ~PAN_74, $Bank ), !Shk_65( ~PAN_74, ~MK_75 ) ]
  --[ Compromise_63( $Bank ), Compromise_63( ~PAN_74 ) ]->
   [ Out( ~MK_75 ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Set_PIN_87:
   [ Fr( ~PIN_84 ), Set_PIN_81( ~PAN_85, CVM_86, $CA, $Bank ) ]
  --[
  NEq_24( CVM_86, 'NoPIN' ), SecretPIN_77( ~PIN_84 ), Honest_78( $CA ),
  Honest_78( $Bank ), Honest_78( ~PAN_85 )
  ]->
   [
   !PIN_83( ~PAN_85, ~PIN_84 ), !Entered_PIN_82( ~PAN_85, ~PIN_84 ),
   !Entered_PIN_82( ~PAN_85, 'WrongPIN' )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Set_Records_112_12tomany:
   [ Fr( ~pid ) ] --> [ StB( ~pid, 'tgk12', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Set_Records_112_12to13_Set_Records_SDA:
   [
   StB( ~pid, 'tgk12', 'empty_tuple' ),
   Set_Records_91( ~PAN_99, ~expDate_95, $CA, certBank_96, SSAD_98, CVM_100
   ),
   !AIP_92( ~PAN_99, <'SDA', u_furtherData_97> )
   ]
  -->
   [
   !Records_93( ~PAN_99,
                <~PAN_99, ~expDate_95, $CA, certBank_96, SSAD_98, CVM_100>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Set_Records_112_12to14_Set_Records_NotSDA:
   [
   StB( ~pid, 'tgk12', 'empty_tuple' ),
   Set_Records_91( ~PAN_106, ~expDate_103, $CA, certBank_104, SSAD_105,
                   CVM_107
   ),
   Fr( ~privkCard_101 ), !AIP_92( ~PAN_106, AIP_108 ),
   !IssuingBank_64( ~PAN_106, $Bank ), !LtkBank_54( $Bank, ~privkBank_102 )
   ]
  --[
  NEq_24( fst(AIP_108), 'SDA' ), SecretPrivkCard_94( ~privkCard_101 ),
  Honest_78( $CA ), Honest_78( $Bank ), Honest_78( ~PAN_106 )
  ]->
   [
   Out( pk(~privkCard_101) ), !LtkCard_70( ~PAN_106, ~privkCard_101 ),
   !Records_93( ~PAN_106,
                <~PAN_106, ~expDate_103, $CA, certBank_104, 
                 <<'04', ~PAN_106, pk(~privkCard_101), $Bank, CVM_107, AIP_108>, 
                  sign(<'04', ~PAN_106, pk(~privkCard_101), $Bank, CVM_107, AIP_108>,
                       ~privkBank_102)
                 >, 
                 CVM_107>
   )
   ]

  /*
  rule (modulo AC) Set_Records_112_12to14_Set_Records_NotSDA:
     [
     StB( ~pid, 'tgk12', 'empty_tuple' ),
     Set_Records_91( ~PAN_106, ~expDate_103, $CA, certBank_104, SSAD_105,
                     CVM_107
     ),
     Fr( ~privkCard_101 ), !AIP_92( ~PAN_106, AIP_108 ),
     !IssuingBank_64( ~PAN_106, $Bank ), !LtkBank_54( $Bank, ~privkBank_102 )
     ]
    --[
    NEq_24( z, 'SDA' ), SecretPrivkCard_94( ~privkCard_101 ),
    Honest_78( $CA ), Honest_78( $Bank ), Honest_78( ~PAN_106 )
    ]->
     [
     Out( pk(~privkCard_101) ), !LtkCard_70( ~PAN_106, ~privkCard_101 ),
     !Records_93( ~PAN_106,
                  <~PAN_106, ~expDate_103, $CA, certBank_104, 
                   <<'04', ~PAN_106, pk(~privkCard_101), $Bank, CVM_107, AIP_108>, 
                    sign(<'04', ~PAN_106, pk(~privkCard_101), $Bank, CVM_107, AIP_108>,
                         ~privkBank_102)
                   >, 
                   CVM_107>
     )
     ]
    variants (modulo AC)
    1. AIP_108
             = AIP_108.17
       z     = fst(AIP_108.17)
    
    2. AIP_108
             = <z.24, x.32>
       z     = z.24
  */

rule (modulo E) Create_Card_122:
   [
   Fr( ~PAN_117 ), Fr( ~expDate_114 ), Fr( ~MK_118 ),
   !LtkBank_54( $Bank, ~privkBank_113 ),
   !CertBank_55( $Bank, certBank_115 ), !IssuingCA_56( $Bank, $CA ),
   In( <auth_116, CVM_119> )
   ]
  --[
  Role_46( ~PAN_117, 'Card' ), SecretPAN_79( ~PAN_117 ),
  SecretMK_80( ~MK_118 ), Honest_78( $CA ), Honest_78( $Bank ),
  Honest_78( ~PAN_117 )
  ]->
   [
   !AIP_92( ~PAN_117, <auth_116, $furtherData> ),
   !AID_88( ~PAN_117, 'Mastercard' ), !Shk_65( ~PAN_117, ~MK_118 ),
   !IssuingBank_64( ~PAN_117, $Bank ),
   Set_Records_91( ~PAN_117, ~expDate_114, $CA, certBank_115,
                   sign(<'03', ~PAN_117, ~expDate_114, auth_116, $furtherData>,
                        ~privkBank_113),
                   CVM_119
   ),
   Set_PIN_81( ~PAN_117, CVM_119, $CA, $Bank )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_168_16to17:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk17', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_168_manyto17tomany_Card_Responds_To_GPO:
   [
   StF( ~pid, 'tgk17', 'empty_tuple' ),
   In( <'GET_PROCESSING_OPTIONS', PDOL_123> ), !AIP_92( ~PAN_124, AIP_126 ),
   !AID_88( ~PAN_124, 'Mastercard' ), !ATC_34( ATC_125 )
   ]
  --[ OneCard_89( ), Once_32( <~PAN_124, ATC_125, 'Card'> ) ]->
   [
   StB( ~pid, 'tgk17', <ATC_125, ~PAN_124, PDOL_123> ),
   Out( <AIP_126, 'AFL'> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA:
   [
   StB( ~pid, 'tgk17', <tgc_ATC_0, ~u_tgany2_128, tgc_PDOL_0> ),
   !AIP_92( ~u_tgany2_128, AIP_129 ),
   !Records_93( ~u_tgany2_128, records_127 ), In( <'READ_RECORD', 'AFL'> )
   ]
  --[ NEq_24( fst(AIP_129), 'DDA' ) ]->
   [
   St( ~pid, 'tgk21', <tgc_ATC_0, ~u_tgany2_128, tgc_PDOL_0> ),
   Out( records_127 )
   ]

  /*
  rule (modulo AC) Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA:
     [
     StB( ~pid, 'tgk17', <tgc_ATC_0, ~u_tgany2_128, tgc_PDOL_0> ),
     !AIP_92( ~u_tgany2_128, AIP_129 ),
     !Records_93( ~u_tgany2_128, records_127 ), In( <'READ_RECORD', 'AFL'> )
     ]
    --[ NEq_24( z, 'DDA' ) ]->
     [
     St( ~pid, 'tgk21', <tgc_ATC_0, ~u_tgany2_128, tgc_PDOL_0> ),
     Out( records_127 )
     ]
    variants (modulo AC)
    1. AIP_129
             = AIP_129.13
       z     = fst(AIP_129.13)
    
    2. AIP_129
             = <z.22, x.32>
       z     = z.22
  */

rule (modulo E) Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA:
   [
   StB( ~pid, 'tgk17', <tgc_ATC_0, ~u_tgany4_131, tgc_PDOL_0> ),
   !Records_93( ~u_tgany4_131, records_130 ),
   !AIP_92( ~u_tgany4_131, <'DDA', u_furtherData_132> ),
   In( <'READ_RECORD', 'AFL'> )
   ]
  -->
   [
   StF( ~pid, 'tgk20', <tgc_ATC_0, ~u_tgany4_131, tgc_PDOL_0> ),
   Out( records_130 )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_168_manyto20to21_Card_Responds_To_InternalAuthenticate:
   [
   StF( ~pid, 'tgk20', <tgc_ATC_0, ~u_tgany3_135, tgc_PDOL_0> ),
   Fr( ~nc_134 ), !LtkCard_70( ~u_tgany3_135, ~privkCard_133 ),
   In( <'INTERNAL_AUTHENTICATE', DDOL_136> )
   ]
  -->
   [
   St( ~pid, 'tgk21', <tgc_ATC_0, ~u_tgany3_135, tgc_PDOL_0> ),
   Out( <~nc_134, sign(<'05', ~nc_134, DDOL_136>, ~privkCard_133)> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_168_21to22_Card_Responds_To_GenerateAC_NoCDA:
   [
   St( ~pid, 'tgk21', <tgc_ATC_0, ~u_tgany0_137, tgc_PDOL_0> ),
   !AIP_92( ~u_tgany0_137, AIP_141 ), !Shk_65( ~u_tgany0_137, ~MK_138 ),
   !IssuingBank_64( ~u_tgany0_137, $Bank ),
   In( <'GENERATE_AC', CID_140, 'NoCDA', 'TVR', CVM_139, 'HHMMSS'> )
   ]
  --[
  Running_90( ~u_tgany0_137, 'Terminal',
              <'Card', 'Terminal', ~u_tgany0_137, AIP_141, CVM_139, 
               <tgc_PDOL_0, 'TVR', CVM_139, 'HHMMSS'>, tgc_ATC_0, 
               MAC_27(f_26(~MK_138, tgc_ATC_0),
                      <<tgc_PDOL_0, 'TVR', CVM_139, 'HHMMSS'>, AIP_141, tgc_ATC_0, 'IAD', 
                       CID_140>), 
               'IAD', CID_140>
  ),
  Running_90( ~u_tgany0_137, $Bank,
              <'Card', 'Bank', ~u_tgany0_137, AIP_141, CVM_139, 
               <tgc_PDOL_0, 'TVR', CVM_139, 'HHMMSS'>, tgc_ATC_0, 
               MAC_27(f_26(~MK_138, tgc_ATC_0),
                      <<tgc_PDOL_0, 'TVR', CVM_139, 'HHMMSS'>, AIP_141, tgc_ATC_0, 'IAD', 
                       CID_140>), 
               'IAD', CID_140>
  )
  ]->
   [
   Out( <CID_140, tgc_ATC_0, 
         MAC_27(f_26(~MK_138, tgc_ATC_0),
                <<tgc_PDOL_0, 'TVR', CVM_139, 'HHMMSS'>, AIP_141, tgc_ATC_0, 'IAD', 
                 CID_140>), 
         'IAD', CID_140>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_168_21to23_Card_Responds_To_GenerateAC_CDA:
   [
   St( ~pid, 'tgk21',
       <tgc_ATC_0, ~u_tgany1_154, amount_153, country_152, currency_151, 
        date_150, type_147, UN_156>
   ),
   !LtkCard_70( ~u_tgany1_154, ~privkCard_148 ),
   !AIP_92( ~u_tgany1_154, <'CDA', u_furtherData_155> ),
   !Shk_65( ~u_tgany1_154, ~MK_157 ),
   !IssuingBank_64( ~u_tgany1_154, $Bank ), Fr( ~nc_149 ),
   In( <'GENERATE_AC', CID_159, 'CDA', 'TVR', CVM_158, 'HHMMSS'> )
   ]
  --[
  Running_90( ~u_tgany1_154, 'Terminal',
              <'Card', 'Terminal', ~u_tgany1_154, <'CDA', u_furtherData_155>, CVM_158, 
               <<amount_153, country_152, currency_151, date_150, type_147, UN_156>, 
                'TVR', CVM_158, 'HHMMSS'>, 
               tgc_ATC_0, 
               MAC_27(f_26(~MK_157, tgc_ATC_0),
                      <
                       <<amount_153, country_152, currency_151, date_150, type_147, UN_156>, 
                        'TVR', CVM_158, 'HHMMSS'>, 
                       <'CDA', u_furtherData_155>, tgc_ATC_0, 'IAD', CID_159>), 
               'IAD', CID_159>
  ),
  Running_90( ~u_tgany1_154, $Bank,
              <'Card', 'Bank', ~u_tgany1_154, <'CDA', u_furtherData_155>, CVM_158, 
               <<amount_153, country_152, currency_151, date_150, type_147, UN_156>, 
                'TVR', CVM_158, 'HHMMSS'>, 
               tgc_ATC_0, 
               MAC_27(f_26(~MK_157, tgc_ATC_0),
                      <
                       <<amount_153, country_152, currency_151, date_150, type_147, UN_156>, 
                        'TVR', CVM_158, 'HHMMSS'>, 
                       <'CDA', u_furtherData_155>, tgc_ATC_0, 'IAD', CID_159>), 
               'IAD', CID_159>
  )
  ]->
   [
   Out( <CID_159, tgc_ATC_0, 
         MAC_27(f_26(~MK_157, tgc_ATC_0),
                <
                 <<amount_153, country_152, currency_151, date_150, type_147, UN_156>, 
                  'TVR', CVM_158, 'HHMMSS'>, 
                 <'CDA', u_furtherData_155>, tgc_ATC_0, 'IAD', CID_159>), 
         <~nc_149, 
          sign(<'05', ~nc_149, CID_159, 
                MAC_27(f_26(~MK_157, tgc_ATC_0),
                       <
                        <<amount_153, country_152, currency_151, date_150, type_147, UN_156>, 
                         'TVR', CVM_158, 'HHMMSS'>, 
                        <'CDA', u_furtherData_155>, tgc_ATC_0, 'IAD', CID_159>), 
                h(<
                   <<amount_153, country_152, currency_151, date_150, type_147, UN_156>, 
                    'TVR', CVM_158, 'HHMMSS'>, 
                   CID_159, tgc_ATC_0, 
                   MAC_27(f_26(~MK_157, tgc_ATC_0),
                          <
                           <<amount_153, country_152, currency_151, date_150, type_147, UN_156>, 
                            'TVR', CVM_158, 'HHMMSS'>, 
                           <'CDA', u_furtherData_155>, tgc_ATC_0, 'IAD', CID_159>), 
                   'IAD', CID_159>), 
                UN_156>,
               ~privkCard_148)
         >, 
         'IAD', CID_159>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Create_Card_Visa_180:
   [
   Fr( ~PAN_175 ), Fr( ~expDate_173 ), Fr( ~privkCard_171 ), Fr( ~MK_176 ),
   !LtkBank_54( $Bank, ~privkBank_172 ),
   !CertBank_55( $Bank, certBank_174 ), !IssuingCA_56( $Bank, $CA )
   ]
  --[
  Role_46( ~PAN_175, 'Card' ), SecretPAN_79( ~PAN_175 ),
  SecretMK_80( ~MK_176 ), SecretPrivkCard_94( ~privkCard_171 ),
  Honest_78( $CA ), Honest_78( $Bank ), Honest_78( ~PAN_175 )
  ]->
   [
   !LtkCard_70( ~PAN_175, ~privkCard_171 ), !AID_88( ~PAN_175, 'Visa' ),
   Out( pk(~privkCard_171) ), !ExpirationDate_169( ~PAN_175, ~expDate_173 ),
   !Shk_65( ~PAN_175, ~MK_176 ), !IssuingBank_64( ~PAN_175, $Bank ),
   !Records_Visa_170( ~PAN_175, ~expDate_173, $CA, certBank_174,
                      <<'04', ~PAN_175, pk(~privkCard_171), $Bank>, 
                       sign(<'04', ~PAN_175, pk(~privkCard_171), $Bank>, ~privkBank_172)>
   ),
   Set_PIN_81( ~PAN_175, 'OnlinePIN', $CA, $Bank )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Visa_242_25tomany:
   [ Fr( ~pid ) ] --> [ StB( ~pid, 'tgk25', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa:
   [
   StB( ~pid, 'tgk25', 'empty_tuple' ),
   In( <'GET_PROCESSING_OPTIONS', <acType_187, CVM_191>, amount_186, 
        country_185, currency_184, date_183, type_181, UN_188>
   ),
   !Shk_65( ~PAN_189, ~MK_190 ), !AID_88( ~PAN_189, 'Visa' ),
   !ExpirationDate_169( ~PAN_189, ~expDate_182 ),
   !IssuingBank_64( ~PAN_189, $Bank ), !ATC_34( ATC_192 )
   ]
  --[
  OneCard_89( ), Once_32( <~PAN_189, ATC_192, 'Card'> ),
  NEq_24( CVM_191, 'CDCVM' ),
  Running_90( ~PAN_189, 'Terminal',
              <'Card', 'Terminal', ~PAN_189, <'EMV', $furtherData>, CVM_191, 
               <<acType_187, CVM_191>, amount_186, country_185, currency_184, date_183, 
                type_181, UN_188>, 
               ATC_192, 
               MAC_27(f_26(~MK_190, ATC_192),
                      <
                       <<acType_187, CVM_191>, amount_186, country_185, currency_184, date_183, 
                        type_181, UN_188>, 
                       <'EMV', $furtherData>, ATC_192, 'IAD', 'ARQC'>), 
               'IAD', 'ARQC'>
  ),
  Running_90( ~PAN_189, $Bank,
              <'Card', 'Bank', ~PAN_189, <'EMV', $furtherData>, CVM_191, 
               <<acType_187, CVM_191>, amount_186, country_185, currency_184, date_183, 
                type_181, UN_188>, 
               ATC_192, 
               MAC_27(f_26(~MK_190, ATC_192),
                      <
                       <<acType_187, CVM_191>, amount_186, country_185, currency_184, date_183, 
                        type_181, UN_188>, 
                       <'EMV', $furtherData>, ATC_192, 'IAD', 'ARQC'>), 
               'IAD', 'ARQC'>
  )
  ]->
   [
   St( ~pid, 'tgk28',
       <
        MAC_27(f_26(~MK_190, ATC_192),
               <
                <<acType_187, CVM_191>, amount_186, country_185, currency_184, date_183, 
                 type_181, UN_188>, 
                <'EMV', $furtherData>, ATC_192, 'IAD', 'ARQC'>), 
        <'EMV', $furtherData>, ATC_192, 'ARQC', CVM_191, <'IAD', 'ARQC'>, 
        ~PAN_189, <acType_187, CVM_191>, amount_186, country_185, currency_184, 
        date_183, type_181, UN_188>
   ),
   Out( <<'EMV', $furtherData>, 'AFL', <~PAN_189, ~expDate_182>, 
         <'IAD', 'ARQC'>, 
         MAC_27(f_26(~MK_190, ATC_192),
                <
                 <<acType_187, CVM_191>, amount_186, country_185, currency_184, date_183, 
                  type_181, UN_188>, 
                 <'EMV', $furtherData>, ATC_192, 'IAD', 'ARQC'>), 
         'ARQC', ATC_192, CVM_191>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa:
   [
   StB( ~pid, 'tgk25', 'empty_tuple' ),
   In( <'GET_PROCESSING_OPTIONS', <CID_211, CVM_210>, amount_206, 
        country_205, currency_204, date_203, type_201, UN_207>
   ),
   !Shk_65( ~PAN_208, ~MK_209 ), !AID_88( ~PAN_208, 'Visa' ),
   !ExpirationDate_169( ~PAN_208, ~expDate_202 ), !ATC_34( ATC_212 )
   ]
  --[
  OneCard_89( ), Once_32( <~PAN_208, ATC_212, 'Card'> ),
  NEq_24( CVM_210, 'CDCVM' )
  ]->
   [
   St( ~pid, 'tgk28',
       <
        MAC_27(f_26(~MK_209, ATC_212),
               <
                <<CID_211, CVM_210>, amount_206, country_205, currency_204, date_203, 
                 type_201, UN_207>, 
                <'DDA', $furtherData>, ATC_212, 'IAD', CID_211>), 
        <'DDA', $furtherData>, ATC_212, CID_211, CVM_210, <'IAD', CID_211>, 
        ~PAN_208, <CID_211, CVM_210>, amount_206, country_205, currency_204, 
        date_203, type_201, UN_207>
   ),
   Out( <<'DDA', $furtherData>, 'AFL', <~PAN_208, ~expDate_202>, 
         <'IAD', CID_211>, 
         MAC_27(f_26(~MK_209, ATC_212),
                <
                 <<CID_211, CVM_210>, amount_206, country_205, currency_204, date_203, 
                  type_201, UN_207>, 
                 <'DDA', $furtherData>, ATC_212, 'IAD', CID_211>), 
         CID_211, ATC_212, CVM_210>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa:
   [
   St( ~pid, 'tgk28',
       <tgc_AC_0, <'EMV', u_furtherData_223>, tgc_ATC_0, tgc_CID_0, tgc_CTQ_0, 
        tgc_IAD_0, ~u_tgany5_222, tgc_PDOL_0>
   ),
   !Records_Visa_170( ~u_tgany5_222, ~expDate_219, $CA, certBank_221,
                      certCard_220
   ),
   In( <'READ_RECORD', 'AFL'> )
   ]
  -->
   [ Out( <~u_tgany5_222, ~expDate_219> ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa:
   [
   St( ~pid, 'tgk28',
       <tgc_AC_0, <'DDA', u_furtherData_236>, tgc_ATC_0, tgc_CID_0, tgc_CTQ_0, 
        tgc_IAD_0, ~u_tgany6_235, TTQ_238, amount_234, country_231, 
        currency_230, date_229, type_224, UN_237>
   ),
   !Records_Visa_170( ~u_tgany6_235, ~expDate_228, $CA, certBank_233,
                      certCard_232
   ),
   Fr( ~nc_226 ), !LtkCard_70( ~u_tgany6_235, ~privkCard_225 ),
   !SDADFormat_35( format_227, tgc_CID_0 ),
   !IssuingBank_64( ~u_tgany6_235, $Bank ), In( <'READ_RECORD', 'AFL'> )
   ]
  --[
  Running_90( ~u_tgany6_235, 'Terminal',
              <'Card', 'Terminal', ~u_tgany6_235, <'DDA', u_furtherData_236>, 
               tgc_CTQ_0, 
               <TTQ_238, amount_234, country_231, currency_230, date_229, type_224, 
                UN_237>, 
               tgc_ATC_0, tgc_AC_0, tgc_IAD_0>
  ),
  Running_90( ~u_tgany6_235, $Bank,
              <'Card', 'Bank', ~u_tgany6_235, <'DDA', u_furtherData_236>, tgc_CTQ_0, 
               <TTQ_238, amount_234, country_231, currency_230, date_229, type_224, 
                UN_237>, 
               tgc_ATC_0, tgc_AC_0, tgc_IAD_0>
  )
  ]->
   [
   Out( <~u_tgany6_235, ~expDate_228, $CA, certBank_233, certCard_232, 
         ~nc_226, tgc_CTQ_0, 
         sign(<format_227, tgc_ATC_0, UN_237, amount_234, 'CHF', ~nc_226, 
               tgc_CTQ_0, 'DDA', u_furtherData_236>,
              ~privkCard_225)
        >
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_31to32:
   [ Fr( ~pid ) ] --> [ StF( ~pid, 'tgk32', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_manyto32to33_Terminal_Sends_GPO:
   [
   StF( ~pid, 'tgk32', 'empty_tuple' ), Fr( ~UN_249 ),
   !Value_33( $amount, value_248 )
   ]
  --[ OneTerminal_243( ), Role_46( $Terminal, 'Terminal' ) ]->
   [
   StF( ~pid, 'tgk33',
        <<$amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN_249>, 
         $Terminal>
   ),
   Out( <'GET_PROCESSING_OPTIONS', $amount, 'Switzerland', 'CHF', 'YYMMDD', 
         'Purchase', ~UN_249>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_manyto33tomany_Terminal_Sends_ReadRecord:
   [ StF( ~pid, 'tgk33', <tgc_PDOL_0, $Terminal> ), In( <AIP_255, 'AFL'> ) ]
  -->
   [
   StB( ~pid, 'tgk33', <AIP_255, tgc_PDOL_0, $Terminal> ),
   Out( <'READ_RECORD', 'AFL'> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_33to34to39_Terminal_Receives_Records_SDA:
   [
   StB( ~pid, 'tgk33', <<'SDA', furtherData_260>, tgc_PDOL_0, $Terminal> ),
   In( <~PAN_263, expDate_261, $CA, 
        <<'02', $Bank, pubkBank_259, $CA>, sign2_256>, SSAD_262, CVM_264>
   ),
   !IssuingCA_56( $Bank, $CA ),
   !CertCA_48( $CA, <<'01', $CA, pubkCA_258, $CA>, sign1_257> )
   ]
  --[
  Eq_25( verify(sign1_257, <'01', $CA, pubkCA_258, $CA>, pubkCA_258), true
  ),
  Eq_25( verify(sign2_256, <'02', $Bank, pubkBank_259, $CA>, pubkCA_258),
         true
  ),
  Eq_25( verify(SSAD_262,
                <'03', ~PAN_263, expDate_261, 'SDA', furtherData_260>, pubkBank_259),
         true
  )
  ]->
   [
   St( ~pid, 'tgk39',
       <<'SDA', furtherData_260>, CVM_264, ~PAN_263, tgc_PDOL_0, $Terminal, 
        $Bank, $CA, pubkBank_259, 'Null'>
   )
   ]

  /*
  rule (modulo AC) Terminal_359_33to34to39_Terminal_Receives_Records_SDA:
     [
     StB( ~pid, 'tgk33', <<'SDA', furtherData_260>, tgc_PDOL_0, $Terminal> ),
     In( <~PAN_263, expDate_261, $CA, 
          <<'02', $Bank, pubkBank_259, $CA>, sign2_256>, SSAD_262, CVM_264>
     ),
     !IssuingCA_56( $Bank, $CA ),
     !CertCA_48( $CA, <<'01', $CA, pubkCA_258, $CA>, sign1_257> )
     ]
    --[ Eq_25( z, true ), Eq_25( z.1, true ), Eq_25( z.2, true ) ]->
     [
     St( ~pid, 'tgk39',
         <<'SDA', furtherData_260>, CVM_264, ~PAN_263, tgc_PDOL_0, $Terminal, 
          $Bank, $CA, pubkBank_259, 'Null'>
     )
     ]
    variants (modulo AC)
    1. $Bank = $Bank.37
       $CA   = $CA.38
       ~PAN_263
             = ~PAN_263.40
       SSAD_262
             = SSAD_262.43
       expDate_261
             = expDate_261.44
       furtherData_260
             = furtherData_260.45
       pubkBank_259
             = pubkBank_259.46
       pubkCA_258
             = pubkCA_258.47
       sign1_257
             = sign1_257.48
       sign2_256
             = sign2_256.49
       z     = verify(sign1_257.48, <'01', $CA.38, pubkCA_258.47, $CA.38>,
                      pubkCA_258.47)
       z.1   = verify(sign2_256.49, <'02', $Bank.37, pubkBank_259.46, $CA.38>,
                      pubkCA_258.47)
       z.2   = verify(SSAD_262.43,
                      <'03', ~PAN_263.40, expDate_261.44, 'SDA', furtherData_260.45>,
                      pubkBank_259.46)
    
    2. $Bank = $Bank.145
       $CA   = $CA.146
       ~PAN_263
             = ~PAN_263.148
       SSAD_262
             = sign(<'03', ~PAN_263.148, expDate_261.152, 'SDA', furtherData_260.153>,
                    x.288)
       expDate_261
             = expDate_261.152
       furtherData_260
             = furtherData_260.153
       pubkBank_259
             = pk(x.288)
       pubkCA_258
             = pubkCA_258.155
       sign1_257
             = sign1_257.156
       sign2_256
             = sign2_256.157
       z     = verify(sign1_257.156, <'01', $CA.146, pubkCA_258.155, $CA.146>,
                      pubkCA_258.155)
       z.1   = verify(sign2_256.157, <'02', $Bank.145, pk(x.288), $CA.146>,
                      pubkCA_258.155)
       z.2   = true
    
    3. $Bank = $Bank.148
       $CA   = $CA.149
       ~PAN_263
             = ~PAN_263.151
       SSAD_262
             = sign(<'03', ~PAN_263.151, expDate_261.155, 'SDA', furtherData_260.156>,
                    x.293)
       expDate_261
             = expDate_261.155
       furtherData_260
             = furtherData_260.156
       pubkBank_259
             = pk(x.293)
       pubkCA_258
             = pk(x.294)
       sign1_257
             = sign(<'01', $CA.149, pk(x.294), $CA.149>, x.294)
       sign2_256
             = sign2_256.160
       z     = true
       z.1   = verify(sign2_256.160, <'02', $Bank.148, pk(x.293), $CA.149>,
                      pk(x.294))
       z.2   = true
    
    4. $Bank = $Bank.149
       $CA   = $CA.150
       ~PAN_263
             = ~PAN_263.152
       SSAD_262
             = SSAD_262.155
       expDate_261
             = expDate_261.156
       furtherData_260
             = furtherData_260.157
       pubkBank_259
             = pubkBank_259.158
       pubkCA_258
             = pk(x.296)
       sign1_257
             = sign(<'01', $CA.150, pk(x.296), $CA.150>, x.296)
       sign2_256
             = sign2_256.161
       z     = true
       z.1   = verify(sign2_256.161,
                      <'02', $Bank.149, pubkBank_259.158, $CA.150>, pk(x.296))
       z.2   = verify(SSAD_262.155,
                      <'03', ~PAN_263.152, expDate_261.156, 'SDA', furtherData_260.157>,
                      pubkBank_259.158)
    
    5. $Bank = $Bank.149
       $CA   = $CA.150
       ~PAN_263
             = ~PAN_263.152
       SSAD_262
             = sign(<'03', ~PAN_263.152, expDate_261.156, 'SDA', furtherData_260.157>,
                    x.295)
       expDate_261
             = expDate_261.156
       furtherData_260
             = furtherData_260.157
       pubkBank_259
             = pk(x.295)
       pubkCA_258
             = pk(x.296)
       sign1_257
             = sign1_257.160
       sign2_256
             = sign(<'02', $Bank.149, pk(x.295), $CA.150>, x.296)
       z     = verify(sign1_257.160, <'01', $CA.150, pk(x.296), $CA.150>,
                      pk(x.296))
       z.1   = true
       z.2   = true
    
    6. $Bank = $Bank.149
       $CA   = $CA.150
       ~PAN_263
             = ~PAN_263.152
       SSAD_262
             = sign(<'03', ~PAN_263.152, expDate_261.156, 'SDA', furtherData_260.157>,
                    x.295)
       expDate_261
             = expDate_261.156
       furtherData_260
             = furtherData_260.157
       pubkBank_259
             = pk(x.295)
       pubkCA_258
             = pk(x.296)
       sign1_257
             = sign(<'01', $CA.150, pk(x.296), $CA.150>, x.296)
       sign2_256
             = sign(<'02', $Bank.149, pk(x.295), $CA.150>, x.296)
       z     = true
       z.1   = true
       z.2   = true
    
    7. $Bank = $Bank.150
       $CA   = $CA.151
       ~PAN_263
             = ~PAN_263.153
       SSAD_262
             = SSAD_262.156
       expDate_261
             = expDate_261.157
       furtherData_260
             = furtherData_260.158
       pubkBank_259
             = pubkBank_259.159
       pubkCA_258
             = pk(x.298)
       sign1_257
             = sign1_257.161
       sign2_256
             = sign(<'02', $Bank.150, pubkBank_259.159, $CA.151>, x.298)
       z     = verify(sign1_257.161, <'01', $CA.151, pk(x.298), $CA.151>,
                      pk(x.298))
       z.1   = true
       z.2   = verify(SSAD_262.156,
                      <'03', ~PAN_263.153, expDate_261.157, 'SDA', furtherData_260.158>,
                      pubkBank_259.159)
    
    8. $Bank = $Bank.150
       $CA   = $CA.151
       ~PAN_263
             = ~PAN_263.153
       SSAD_262
             = SSAD_262.156
       expDate_261
             = expDate_261.157
       furtherData_260
             = furtherData_260.158
       pubkBank_259
             = pubkBank_259.159
       pubkCA_258
             = pk(x.298)
       sign1_257
             = sign(<'01', $CA.151, pk(x.298), $CA.151>, x.298)
       sign2_256
             = sign(<'02', $Bank.150, pubkBank_259.159, $CA.151>, x.298)
       z     = true
       z.1   = true
       z.2   = verify(SSAD_262.156,
                      <'03', ~PAN_263.153, expDate_261.157, 'SDA', furtherData_260.158>,
                      pubkBank_259.159)
  */

rule (modulo E) Terminal_359_33to35to39_Terminal_Receives_Records_CDA:
   [
   StB( ~pid, 'tgk33', <<'CDA', furtherData_272>, tgc_PDOL_0, $Terminal> ),
   In( <~PAN_274, expDate_273, $CA, 
        <<'02', $Bank, pubkBank_271, $CA>, sign2_267>, 
        <<'04', ~PAN_274, pubkCard_269, $Bank, CVM_275, 'CDA', furtherData_272>, 
         sign3_266>, 
        CVM_275>
   ),
   !IssuingCA_56( $Bank, $CA ),
   !CertCA_48( $CA, <<'01', $CA, pubkCA_270, $CA>, sign1_268> )
   ]
  --[
  Eq_25( verify(sign1_268, <'01', $CA, pubkCA_270, $CA>, pubkCA_270), true
  ),
  Eq_25( verify(sign2_267, <'02', $Bank, pubkBank_271, $CA>, pubkCA_270),
         true
  ),
  Eq_25( verify(sign3_266,
                <'04', ~PAN_274, pubkCard_269, $Bank, CVM_275, 'CDA', furtherData_272>,
                pubkBank_271),
         true
  )
  ]->
   [
   St( ~pid, 'tgk39',
       <<'CDA', furtherData_272>, CVM_275, ~PAN_274, tgc_PDOL_0, $Terminal, 
        $Bank, $CA, pubkBank_271, pubkCard_269>
   )
   ]

  /*
  rule (modulo AC) Terminal_359_33to35to39_Terminal_Receives_Records_CDA:
     [
     StB( ~pid, 'tgk33', <<'CDA', furtherData_272>, tgc_PDOL_0, $Terminal> ),
     In( <~PAN_274, expDate_273, $CA, 
          <<'02', $Bank, pubkBank_271, $CA>, sign2_267>, 
          <<'04', ~PAN_274, pubkCard_269, $Bank, CVM_275, 'CDA', furtherData_272>, 
           sign3_266>, 
          CVM_275>
     ),
     !IssuingCA_56( $Bank, $CA ),
     !CertCA_48( $CA, <<'01', $CA, pubkCA_270, $CA>, sign1_268> )
     ]
    --[ Eq_25( z, true ), Eq_25( z.1, true ), Eq_25( z.2, true ) ]->
     [
     St( ~pid, 'tgk39',
         <<'CDA', furtherData_272>, CVM_275, ~PAN_274, tgc_PDOL_0, $Terminal, 
          $Bank, $CA, pubkBank_271, pubkCard_269>
     )
     ]
    variants (modulo AC)
    1. $Bank = $Bank.39
       $CA   = $CA.40
       ~PAN_274
             = ~PAN_274.42
       CVM_275
             = CVM_275.44
       furtherData_272
             = furtherData_272.46
       pubkBank_271
             = pubkBank_271.47
       pubkCA_270
             = pubkCA_270.48
       pubkCard_269
             = pubkCard_269.49
       sign1_268
             = sign1_268.50
       sign2_267
             = sign2_267.51
       sign3_266
             = sign3_266.52
       z     = verify(sign1_268.50, <'01', $CA.40, pubkCA_270.48, $CA.40>,
                      pubkCA_270.48)
       z.1   = verify(sign2_267.51, <'02', $Bank.39, pubkBank_271.47, $CA.40>,
                      pubkCA_270.48)
       z.2   = verify(sign3_266.52,
                      <'04', ~PAN_274.42, pubkCard_269.49, $Bank.39, CVM_275.44, 'CDA', 
                       furtherData_272.46>,
                      pubkBank_271.47)
    
    2. $Bank = $Bank.154
       $CA   = $CA.155
       ~PAN_274
             = ~PAN_274.157
       CVM_275
             = CVM_275.159
       furtherData_272
             = furtherData_272.161
       pubkBank_271
             = pubkBank_271.162
       pubkCA_270
             = pk(x.306)
       pubkCard_269
             = pubkCard_269.164
       sign1_268
             = sign(<'01', $CA.155, pk(x.306), $CA.155>, x.306)
       sign2_267
             = sign2_267.166
       sign3_266
             = sign3_266.167
       z     = true
       z.1   = verify(sign2_267.166,
                      <'02', $Bank.154, pubkBank_271.162, $CA.155>, pk(x.306))
       z.2   = verify(sign3_266.167,
                      <'04', ~PAN_274.157, pubkCard_269.164, $Bank.154, CVM_275.159, 'CDA', 
                       furtherData_272.161>,
                      pubkBank_271.162)
    
    3. $Bank = $Bank.154
       $CA   = $CA.155
       ~PAN_274
             = ~PAN_274.157
       CVM_275
             = CVM_275.159
       furtherData_272
             = furtherData_272.161
       pubkBank_271
             = pk(x.306)
       pubkCA_270
             = pubkCA_270.163
       pubkCard_269
             = pubkCard_269.164
       sign1_268
             = sign1_268.165
       sign2_267
             = sign2_267.166
       sign3_266
             = sign(<'04', ~PAN_274.157, pubkCard_269.164, $Bank.154, CVM_275.159, 
                     'CDA', furtherData_272.161>,
                    x.306)
       z     = verify(sign1_268.165, <'01', $CA.155, pubkCA_270.163, $CA.155>,
                      pubkCA_270.163)
       z.1   = verify(sign2_267.166, <'02', $Bank.154, pk(x.306), $CA.155>,
                      pubkCA_270.163)
       z.2   = true
    
    4. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_274
             = ~PAN_274.158
       CVM_275
             = CVM_275.160
       furtherData_272
             = furtherData_272.162
       pubkBank_271
             = pubkBank_271.163
       pubkCA_270
             = pk(x.308)
       pubkCard_269
             = pubkCard_269.165
       sign1_268
             = sign1_268.166
       sign2_267
             = sign(<'02', $Bank.155, pubkBank_271.163, $CA.156>, x.308)
       sign3_266
             = sign3_266.168
       z     = verify(sign1_268.166, <'01', $CA.156, pk(x.308), $CA.156>,
                      pk(x.308))
       z.1   = true
       z.2   = verify(sign3_266.168,
                      <'04', ~PAN_274.158, pubkCard_269.165, $Bank.155, CVM_275.160, 'CDA', 
                       furtherData_272.162>,
                      pubkBank_271.163)
    
    5. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_274
             = ~PAN_274.158
       CVM_275
             = CVM_275.160
       furtherData_272
             = furtherData_272.162
       pubkBank_271
             = pubkBank_271.163
       pubkCA_270
             = pk(x.308)
       pubkCard_269
             = pubkCard_269.165
       sign1_268
             = sign(<'01', $CA.156, pk(x.308), $CA.156>, x.308)
       sign2_267
             = sign(<'02', $Bank.155, pubkBank_271.163, $CA.156>, x.308)
       sign3_266
             = sign3_266.168
       z     = true
       z.1   = true
       z.2   = verify(sign3_266.168,
                      <'04', ~PAN_274.158, pubkCard_269.165, $Bank.155, CVM_275.160, 'CDA', 
                       furtherData_272.162>,
                      pubkBank_271.163)
    
    6. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_274
             = ~PAN_274.158
       CVM_275
             = CVM_275.160
       furtherData_272
             = furtherData_272.162
       pubkBank_271
             = pk(x.307)
       pubkCA_270
             = pk(x.308)
       pubkCard_269
             = pubkCard_269.165
       sign1_268
             = sign1_268.166
       sign2_267
             = sign(<'02', $Bank.155, pk(x.307), $CA.156>, x.308)
       sign3_266
             = sign(<'04', ~PAN_274.158, pubkCard_269.165, $Bank.155, CVM_275.160, 
                     'CDA', furtherData_272.162>,
                    x.307)
       z     = verify(sign1_268.166, <'01', $CA.156, pk(x.308), $CA.156>,
                      pk(x.308))
       z.1   = true
       z.2   = true
    
    7. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_274
             = ~PAN_274.158
       CVM_275
             = CVM_275.160
       furtherData_272
             = furtherData_272.162
       pubkBank_271
             = pk(x.307)
       pubkCA_270
             = pk(x.308)
       pubkCard_269
             = pubkCard_269.165
       sign1_268
             = sign(<'01', $CA.156, pk(x.308), $CA.156>, x.308)
       sign2_267
             = sign2_267.167
       sign3_266
             = sign(<'04', ~PAN_274.158, pubkCard_269.165, $Bank.155, CVM_275.160, 
                     'CDA', furtherData_272.162>,
                    x.307)
       z     = true
       z.1   = verify(sign2_267.167, <'02', $Bank.155, pk(x.307), $CA.156>,
                      pk(x.308))
       z.2   = true
    
    8. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_274
             = ~PAN_274.158
       CVM_275
             = CVM_275.160
       furtherData_272
             = furtherData_272.162
       pubkBank_271
             = pk(x.307)
       pubkCA_270
             = pk(x.308)
       pubkCard_269
             = pubkCard_269.165
       sign1_268
             = sign(<'01', $CA.156, pk(x.308), $CA.156>, x.308)
       sign2_267
             = sign(<'02', $Bank.155, pk(x.307), $CA.156>, x.308)
       sign3_266
             = sign(<'04', ~PAN_274.158, pubkCard_269.165, $Bank.155, CVM_275.160, 
                     'CDA', furtherData_272.162>,
                    x.307)
       z     = true
       z.1   = true
       z.2   = true
  */

rule (modulo E) Terminal_359_33to36to37_Terminal_Receives_Records_DDA:
   [
   StB( ~pid, 'tgk33', <<'DDA', furtherData_283>, tgc_PDOL_0, $Terminal> ),
   !IssuingCA_56( $Bank, $CA ),
   In( <~PAN_285, expDate_284, $CA, 
        <<'02', $Bank, pubkBank_282, $CA>, sign2_278>, 
        <<'04', ~PAN_285, pubkCard_280, $Bank, CVM_286, 'DDA', furtherData_283>, 
         sign3_277>, 
        CVM_286>
   ),
   !CertCA_48( $CA, <<'01', $CA, pubkCA_281, $CA>, sign1_279> )
   ]
  --[
  Eq_25( verify(sign1_279, <'01', $CA, pubkCA_281, $CA>, pubkCA_281), true
  ),
  Eq_25( verify(sign2_278, <'02', $Bank, pubkBank_282, $CA>, pubkCA_281),
         true
  ),
  Eq_25( verify(sign3_277,
                <'04', ~PAN_285, pubkCard_280, $Bank, CVM_286, 'DDA', furtherData_283>,
                pubkBank_282),
         true
  )
  ]->
   [
   StF( ~pid, 'tgk37',
        <<'DDA', furtherData_283>, CVM_286, ~PAN_285, tgc_PDOL_0, $Terminal, 
         $Bank, $CA, pubkBank_282, pubkCard_280>
   )
   ]

  /*
  rule (modulo AC) Terminal_359_33to36to37_Terminal_Receives_Records_DDA:
     [
     StB( ~pid, 'tgk33', <<'DDA', furtherData_283>, tgc_PDOL_0, $Terminal> ),
     !IssuingCA_56( $Bank, $CA ),
     In( <~PAN_285, expDate_284, $CA, 
          <<'02', $Bank, pubkBank_282, $CA>, sign2_278>, 
          <<'04', ~PAN_285, pubkCard_280, $Bank, CVM_286, 'DDA', furtherData_283>, 
           sign3_277>, 
          CVM_286>
     ),
     !CertCA_48( $CA, <<'01', $CA, pubkCA_281, $CA>, sign1_279> )
     ]
    --[ Eq_25( z, true ), Eq_25( z.1, true ), Eq_25( z.2, true ) ]->
     [
     StF( ~pid, 'tgk37',
          <<'DDA', furtherData_283>, CVM_286, ~PAN_285, tgc_PDOL_0, $Terminal, 
           $Bank, $CA, pubkBank_282, pubkCard_280>
     )
     ]
    variants (modulo AC)
    1. $Bank = $Bank.39
       $CA   = $CA.40
       ~PAN_285
             = ~PAN_285.42
       CVM_286
             = CVM_286.44
       furtherData_283
             = furtherData_283.46
       pubkBank_282
             = pubkBank_282.47
       pubkCA_281
             = pubkCA_281.48
       pubkCard_280
             = pubkCard_280.49
       sign1_279
             = sign1_279.50
       sign2_278
             = sign2_278.51
       sign3_277
             = sign3_277.52
       z     = verify(sign1_279.50, <'01', $CA.40, pubkCA_281.48, $CA.40>,
                      pubkCA_281.48)
       z.1   = verify(sign2_278.51, <'02', $Bank.39, pubkBank_282.47, $CA.40>,
                      pubkCA_281.48)
       z.2   = verify(sign3_277.52,
                      <'04', ~PAN_285.42, pubkCard_280.49, $Bank.39, CVM_286.44, 'DDA', 
                       furtherData_283.46>,
                      pubkBank_282.47)
    
    2. $Bank = $Bank.154
       $CA   = $CA.155
       ~PAN_285
             = ~PAN_285.157
       CVM_286
             = CVM_286.159
       furtherData_283
             = furtherData_283.161
       pubkBank_282
             = pubkBank_282.162
       pubkCA_281
             = pk(x.306)
       pubkCard_280
             = pubkCard_280.164
       sign1_279
             = sign(<'01', $CA.155, pk(x.306), $CA.155>, x.306)
       sign2_278
             = sign2_278.166
       sign3_277
             = sign3_277.167
       z     = true
       z.1   = verify(sign2_278.166,
                      <'02', $Bank.154, pubkBank_282.162, $CA.155>, pk(x.306))
       z.2   = verify(sign3_277.167,
                      <'04', ~PAN_285.157, pubkCard_280.164, $Bank.154, CVM_286.159, 'DDA', 
                       furtherData_283.161>,
                      pubkBank_282.162)
    
    3. $Bank = $Bank.154
       $CA   = $CA.155
       ~PAN_285
             = ~PAN_285.157
       CVM_286
             = CVM_286.159
       furtherData_283
             = furtherData_283.161
       pubkBank_282
             = pk(x.306)
       pubkCA_281
             = pubkCA_281.163
       pubkCard_280
             = pubkCard_280.164
       sign1_279
             = sign1_279.165
       sign2_278
             = sign2_278.166
       sign3_277
             = sign(<'04', ~PAN_285.157, pubkCard_280.164, $Bank.154, CVM_286.159, 
                     'DDA', furtherData_283.161>,
                    x.306)
       z     = verify(sign1_279.165, <'01', $CA.155, pubkCA_281.163, $CA.155>,
                      pubkCA_281.163)
       z.1   = verify(sign2_278.166, <'02', $Bank.154, pk(x.306), $CA.155>,
                      pubkCA_281.163)
       z.2   = true
    
    4. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_285
             = ~PAN_285.158
       CVM_286
             = CVM_286.160
       furtherData_283
             = furtherData_283.162
       pubkBank_282
             = pubkBank_282.163
       pubkCA_281
             = pk(x.308)
       pubkCard_280
             = pubkCard_280.165
       sign1_279
             = sign1_279.166
       sign2_278
             = sign(<'02', $Bank.155, pubkBank_282.163, $CA.156>, x.308)
       sign3_277
             = sign3_277.168
       z     = verify(sign1_279.166, <'01', $CA.156, pk(x.308), $CA.156>,
                      pk(x.308))
       z.1   = true
       z.2   = verify(sign3_277.168,
                      <'04', ~PAN_285.158, pubkCard_280.165, $Bank.155, CVM_286.160, 'DDA', 
                       furtherData_283.162>,
                      pubkBank_282.163)
    
    5. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_285
             = ~PAN_285.158
       CVM_286
             = CVM_286.160
       furtherData_283
             = furtherData_283.162
       pubkBank_282
             = pubkBank_282.163
       pubkCA_281
             = pk(x.308)
       pubkCard_280
             = pubkCard_280.165
       sign1_279
             = sign(<'01', $CA.156, pk(x.308), $CA.156>, x.308)
       sign2_278
             = sign(<'02', $Bank.155, pubkBank_282.163, $CA.156>, x.308)
       sign3_277
             = sign3_277.168
       z     = true
       z.1   = true
       z.2   = verify(sign3_277.168,
                      <'04', ~PAN_285.158, pubkCard_280.165, $Bank.155, CVM_286.160, 'DDA', 
                       furtherData_283.162>,
                      pubkBank_282.163)
    
    6. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_285
             = ~PAN_285.158
       CVM_286
             = CVM_286.160
       furtherData_283
             = furtherData_283.162
       pubkBank_282
             = pk(x.307)
       pubkCA_281
             = pk(x.308)
       pubkCard_280
             = pubkCard_280.165
       sign1_279
             = sign1_279.166
       sign2_278
             = sign(<'02', $Bank.155, pk(x.307), $CA.156>, x.308)
       sign3_277
             = sign(<'04', ~PAN_285.158, pubkCard_280.165, $Bank.155, CVM_286.160, 
                     'DDA', furtherData_283.162>,
                    x.307)
       z     = verify(sign1_279.166, <'01', $CA.156, pk(x.308), $CA.156>,
                      pk(x.308))
       z.1   = true
       z.2   = true
    
    7. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_285
             = ~PAN_285.158
       CVM_286
             = CVM_286.160
       furtherData_283
             = furtherData_283.162
       pubkBank_282
             = pk(x.307)
       pubkCA_281
             = pk(x.308)
       pubkCard_280
             = pubkCard_280.165
       sign1_279
             = sign(<'01', $CA.156, pk(x.308), $CA.156>, x.308)
       sign2_278
             = sign2_278.167
       sign3_277
             = sign(<'04', ~PAN_285.158, pubkCard_280.165, $Bank.155, CVM_286.160, 
                     'DDA', furtherData_283.162>,
                    x.307)
       z     = true
       z.1   = verify(sign2_278.167, <'02', $Bank.155, pk(x.307), $CA.156>,
                      pk(x.308))
       z.2   = true
    
    8. $Bank = $Bank.155
       $CA   = $CA.156
       ~PAN_285
             = ~PAN_285.158
       CVM_286
             = CVM_286.160
       furtherData_283
             = furtherData_283.162
       pubkBank_282
             = pk(x.307)
       pubkCA_281
             = pk(x.308)
       pubkCard_280
             = pubkCard_280.165
       sign1_279
             = sign(<'01', $CA.156, pk(x.308), $CA.156>, x.308)
       sign2_278
             = sign(<'02', $Bank.155, pk(x.307), $CA.156>, x.308)
       sign3_277
             = sign(<'04', ~PAN_285.158, pubkCard_280.165, $Bank.155, CVM_286.160, 
                     'DDA', furtherData_283.162>,
                    x.307)
       z     = true
       z.1   = true
       z.2   = true
  */

rule (modulo E) Terminal_359_manyto37to38_Terminal_Sends_InternalAuthenticate:
   [
   StF( ~pid, 'tgk37',
        <tgc_AIP_0, tgc_CVM_0, ~u_tgany16_292, 
         <$amount, country_291, currency_290, date_289, type_288, ~UN_293>, 
         $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk38',
        <tgc_AIP_0, tgc_CVM_0, ~u_tgany16_292, 
         <$amount, country_291, currency_290, date_289, type_288, ~UN_293>, 
         $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
   ),
   Out( <'INTERNAL_AUTHENTICATE', ~UN_293> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_manyto38to39_Terminal_Receives_InternalAuthenticate_Response:
   [
   StF( ~pid, 'tgk38',
        <tgc_AIP_0, tgc_CVM_0, ~u_tgany15_300, 
         <$amount, country_299, currency_298, date_297, type_295, ~UN_301>, 
         $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
   ),
   In( <nc_296, SDAD_302> )
   ]
  --[
  Eq_25( verify(SDAD_302, <'05', nc_296, ~UN_301>, tgc_pubkCard_0), true )
  ]->
   [
   St( ~pid, 'tgk39',
       <tgc_AIP_0, tgc_CVM_0, ~u_tgany15_300, 
        <$amount, country_299, currency_298, date_297, type_295, ~UN_301>, 
        $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
   )
   ]

  /*
  rule (modulo AC) Terminal_359_manyto38to39_Terminal_Receives_InternalAuthenticate_Response:
     [
     StF( ~pid, 'tgk38',
          <tgc_AIP_0, tgc_CVM_0, ~u_tgany15_300, 
           <$amount, country_299, currency_298, date_297, type_295, ~UN_301>, 
           $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
     ),
     In( <nc_296, SDAD_302> )
     ]
    --[ Eq_25( z, true ) ]->
     [
     St( ~pid, 'tgk39',
         <tgc_AIP_0, tgc_CVM_0, ~u_tgany15_300, 
          <$amount, country_299, currency_298, date_297, type_295, ~UN_301>, 
          $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
     )
     ]
    variants (modulo AC)
    1. ~UN_301
             = ~UN_301.33
       SDAD_302
             = SDAD_302.36
       nc_296
             = nc_296.40
       tgc_pubkCard_0
             = tgc_pubkCard_0.44
       z     = verify(SDAD_302.36, <'05', nc_296.40, ~UN_301.33>,
                      tgc_pubkCard_0.44)
    
    2. ~UN_301
             = ~UN_301.42
       SDAD_302
             = sign(<'05', nc_296.49, ~UN_301.42>, x.78)
       nc_296
             = nc_296.49
       tgc_pubkCard_0
             = pk(x.78)
       z     = true
  */

rule (modulo E) Terminal_359_39to40to43_Terminal_Processes_CVM_NoPIN:
   [
   St( ~pid, 'tgk39',
       <tgc_AIP_0, tgc_CVM_0, ~u_tgany12_307, 
        <$amount, country_306, currency_305, date_304, type_303, ~UN_308>, 
        $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
   ),
   !Value_33( $amount, 'Low' )
   ]
  -->
   [
   St( ~pid, 'tgk43',
       <tgc_AIP_0, 'NoPIN', ~u_tgany12_307, 
        <$amount, country_306, currency_305, date_304, type_303, ~UN_308>, 
        $Terminal, $Bank, $CA, 'Null', tgc_pubkCard_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_39to41to43_Terminal_Processes_CVM_OnlinePIN:
   [
   St( ~pid, 'tgk39',
       <tgc_AIP_0, 'OnlinePIN', ~u_tgany13_313, 
        <$amount, country_312, currency_311, date_310, type_309, ~UN_314>, 
        $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
   ),
   !Entered_PIN_82( ~u_tgany13_313, PIN_315 ), !Value_33( $amount, 'High' )
   ]
  -->
   [
   St( ~pid, 'tgk43',
       <tgc_AIP_0, 'OnlinePIN', ~u_tgany13_313, 
        <$amount, country_312, currency_311, date_310, type_309, ~UN_314>, 
        $Terminal, $Bank, $CA, aenc(PIN_315, tgc_pubkBank_0), tgc_pubkCard_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_39to42to43_Terminal_Processes_CVM_ODCVM:
   [
   St( ~pid, 'tgk39',
       <<auth_321, 'ODCVM', furtherData2_317>, tgc_CVM_0, ~u_tgany14_322, 
        <$amount, country_320, currency_319, date_318, type_316, ~UN_323>, 
        $Terminal, $Bank, $CA, tgc_pubkBank_0, tgc_pubkCard_0>
   ),
   !Value_33( $amount, 'High' )
   ]
  -->
   [
   St( ~pid, 'tgk43',
       <<auth_321, 'ODCVM', furtherData2_317>, 'ODCVM', ~u_tgany14_322, 
        <$amount, country_320, currency_319, date_318, type_316, ~UN_323>, 
        $Terminal, $Bank, $CA, 'Null', tgc_pubkCard_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_43to44to45_Terminal_Sends_GenerateAC_NoCDA:
   [
   St( ~pid, 'tgk43',
       <tgc_AIP_0, tgc_CVM_0, ~u_tgany8_325, tgc_PDOL_0, $Terminal, $Bank, $CA, 
        tgc_encPIN_0, tgc_pubkCard_0>
   ),
   In( acType_324 )
   ]
  --[ NEq_24( fst(tgc_AIP_0), 'CDA' ) ]->
   [
   StF( ~pid, 'tgk45',
        <tgc_AIP_0, tgc_CVM_0, ~u_tgany8_325, $Terminal, $Bank, $CA, 
         <tgc_PDOL_0, 'TVR', tgc_CVM_0, 'HHMMSS'>, acType_324, tgc_encPIN_0>
   ),
   Out( <'GENERATE_AC', acType_324, 'NoCDA', 'TVR', tgc_CVM_0, 'HHMMSS'> )
   ]

  /*
  rule (modulo AC) Terminal_359_43to44to45_Terminal_Sends_GenerateAC_NoCDA:
     [
     St( ~pid, 'tgk43',
         <tgc_AIP_0, tgc_CVM_0, ~u_tgany8_325, tgc_PDOL_0, $Terminal, $Bank, $CA, 
          tgc_encPIN_0, tgc_pubkCard_0>
     ),
     In( acType_324 )
     ]
    --[ NEq_24( z, 'CDA' ) ]->
     [
     StF( ~pid, 'tgk45',
          <tgc_AIP_0, tgc_CVM_0, ~u_tgany8_325, $Terminal, $Bank, $CA, 
           <tgc_PDOL_0, 'TVR', tgc_CVM_0, 'HHMMSS'>, acType_324, tgc_encPIN_0>
     ),
     Out( <'GENERATE_AC', acType_324, 'NoCDA', 'TVR', tgc_CVM_0, 'HHMMSS'> )
     ]
    variants (modulo AC)
    1. tgc_AIP_0
             = tgc_AIP_0.20
       z     = fst(tgc_AIP_0.20)
    
    2. tgc_AIP_0
             = <z.33, x.47>
       z     = z.33
  */

rule (modulo E) Terminal_359_43to46to47_Terminal_Sends_GenerateAC_CDA:
   [
   St( ~pid, 'tgk43',
       <<'CDA', u_furtherData_339>, tgc_CVM_0, ~u_tgany11_338, tgc_PDOL_0, 
        $Terminal, $Bank, $CA, tgc_encPIN_0, tgc_pubkCard_0>
   ),
   In( acType_337 )
   ]
  -->
   [
   StF( ~pid, 'tgk47',
        <<'CDA', u_furtherData_339>, tgc_CVM_0, ~u_tgany11_338, $Terminal, 
         $Bank, $CA, <tgc_PDOL_0, 'TVR', tgc_CVM_0, 'HHMMSS'>, acType_337, 
         tgc_encPIN_0, tgc_pubkCard_0>
   ),
   Out( <'GENERATE_AC', acType_337, 'CDA', 'TVR', tgc_CVM_0, 'HHMMSS'> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_manyto45_Terminal_Receives_AC_NoCDA:
   [
   StF( ~pid, 'tgk45',
        <tgc_AIP_0, tgc_CVM_0, ~u_tgany7_329, $Terminal, $Bank, $CA, 
         <PDOL_330, CDOL1_333>, tgc_acType_0, tgc_encPIN_0>
   ),
   In( <CID_332, ATC_334, AC_335, IAD_331> ), Fr( ~channelID_328 )
   ]
  --[
  Compatible_CID_acType_244( CID_332, tgc_acType_0 ),
  Compatible_CID_CVM_245( CID_332, tgc_CVM_0 ),
  Running_90( $Terminal, $Bank,
              <'Terminal', 'Bank', ~u_tgany7_329, tgc_AIP_0, tgc_CVM_0, 
               <PDOL_330, CDOL1_333>, ATC_334, AC_335, IAD_331>
  )
  ]->
   [
   Send_30( $Terminal, $Bank, <~channelID_328, 'Mastercard', '1'>,
            <
             <~u_tgany7_329, tgc_AIP_0, tgc_CVM_0, <PDOL_330, CDOL1_333>, ATC_334, 
              AC_335, IAD_331>, 
             tgc_encPIN_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_359_manyto47_Terminal_Receives_AC_CDA:
   [
   StF( ~pid, 'tgk47',
        <tgc_AIP_0, tgc_CVM_0, ~u_tgany9_348, $Terminal, $Bank, $CA, 
         <<$amount, country_346, currency_345, date_344, type_342, ~UN_350>, 
          u_tgany10_349>, 
         tgc_acType_0, tgc_encPIN_0, tgc_pubkCard_0>
   ),
   In( <CID_353, ATC_354, AC_355, <nc_343, SDAD_351>, IAD_352> ),
   Fr( ~channelID_347 )
   ]
  --[
  Compatible_CID_acType_244( CID_353, tgc_acType_0 ),
  Compatible_CID_CVM_245( CID_353, tgc_CVM_0 ),
  Eq_25( verify(SDAD_351,
                <'05', nc_343, CID_353, AC_355, 
                 h(<
                    <<$amount, country_346, currency_345, date_344, type_342, ~UN_350>, 
                     u_tgany10_349>, 
                    CID_353, ATC_354, AC_355, IAD_352>), 
                 ~UN_350>,
                tgc_pubkCard_0),
         true
  ),
  Running_90( $Terminal, $Bank,
              <'Terminal', 'Bank', ~u_tgany9_348, tgc_AIP_0, tgc_CVM_0, 
               <<$amount, country_346, currency_345, date_344, type_342, ~UN_350>, 
                u_tgany10_349>, 
               ATC_354, AC_355, IAD_352>
  )
  ]->
   [
   Send_30( $Terminal, $Bank, <~channelID_347, 'Mastercard', '1'>,
            <
             <~u_tgany9_348, tgc_AIP_0, tgc_CVM_0, 
              <<$amount, country_346, currency_345, date_344, type_342, ~UN_350>, 
               u_tgany10_349>, 
              ATC_354, AC_355, IAD_352>, 
             tgc_encPIN_0>
   )
   ]

  /*
  rule (modulo AC) Terminal_359_manyto47_Terminal_Receives_AC_CDA:
     [
     StF( ~pid, 'tgk47',
          <tgc_AIP_0, tgc_CVM_0, ~u_tgany9_348, $Terminal, $Bank, $CA, 
           <<$amount, country_346, currency_345, date_344, type_342, ~UN_350>, 
            u_tgany10_349>, 
           tgc_acType_0, tgc_encPIN_0, tgc_pubkCard_0>
     ),
     In( <CID_353, ATC_354, AC_355, <nc_343, SDAD_351>, IAD_352> ),
     Fr( ~channelID_347 )
     ]
    --[
    Compatible_CID_acType_244( CID_353, tgc_acType_0 ),
    Compatible_CID_CVM_245( CID_353, tgc_CVM_0 ), Eq_25( z, true ),
    Running_90( $Terminal, $Bank,
                <'Terminal', 'Bank', ~u_tgany9_348, tgc_AIP_0, tgc_CVM_0, 
                 <<$amount, country_346, currency_345, date_344, type_342, ~UN_350>, 
                  u_tgany10_349>, 
                 ATC_354, AC_355, IAD_352>
    )
    ]->
     [
     Send_30( $Terminal, $Bank, <~channelID_347, 'Mastercard', '1'>,
              <
               <~u_tgany9_348, tgc_AIP_0, tgc_CVM_0, 
                <<$amount, country_346, currency_345, date_344, type_342, ~UN_350>, 
                 u_tgany10_349>, 
                ATC_354, AC_355, IAD_352>, 
               tgc_encPIN_0>
     )
     ]
    variants (modulo AC)
    1. $amount
             = $amount.50
       ~UN_350
             = ~UN_350.51
       AC_355
             = AC_355.55
       ATC_354
             = ATC_354.56
       CID_353
             = CID_353.57
       IAD_352
             = IAD_352.58
       SDAD_351
             = SDAD_351.59
       country_346
             = country_346.60
       currency_345
             = currency_345.61
       date_344
             = date_344.62
       nc_343
             = nc_343.63
       tgc_pubkCard_0
             = tgc_pubkCard_0.68
       type_342
             = type_342.69
       u_tgany10_349
             = u_tgany10_349.70
       z     = verify(SDAD_351.59,
                      <'05', nc_343.63, CID_353.57, AC_355.55, 
                       h(<
                          <
                           <$amount.50, country_346.60, currency_345.61, date_344.62, type_342.69, 
                            ~UN_350.51>, 
                           u_tgany10_349.70>, 
                          CID_353.57, ATC_354.56, AC_355.55, IAD_352.58>), 
                       ~UN_350.51>,
                      tgc_pubkCard_0.68)
    
    2. $amount
             = $amount.153
       ~UN_350
             = ~UN_350.154
       AC_355
             = AC_355.158
       ATC_354
             = ATC_354.159
       CID_353
             = CID_353.160
       IAD_352
             = IAD_352.161
       SDAD_351
             = sign(<'05', nc_343.166, CID_353.160, AC_355.158, 
                     h(<
                        <
                         <$amount.153, country_346.163, currency_345.164, date_344.165, 
                          type_342.172, ~UN_350.154>, 
                         u_tgany10_349.173>, 
                        CID_353.160, ATC_354.159, AC_355.158, IAD_352.161>), 
                     ~UN_350.154>,
                    x.301)
       country_346
             = country_346.163
       currency_345
             = currency_345.164
       date_344
             = date_344.165
       nc_343
             = nc_343.166
       tgc_pubkCard_0
             = pk(x.301)
       type_342
             = type_342.172
       u_tgany10_349
             = u_tgany10_349.173
       z     = true
  */

rule (modulo E) Terminal_Visa_459_48tomany:
   [ Fr( ~pid ) ] --> [ StB( ~pid, 'tgk48', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_48to49to51_Terminal_Sends_GPO_Low_Visa:
   [
   StB( ~pid, 'tgk48', 'empty_tuple' ), Fr( ~UN_360 ),
   !Value_33( $amount, 'Low' )
   ]
  --[ OneTerminal_243( ), Role_46( $Terminal, 'Terminal' ) ]->
   [
   StF( ~pid, 'tgk51',
        <
         <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
          ~UN_360>, 
         $Terminal>
   ),
   Out( <'GET_PROCESSING_OPTIONS', <'TC', 'NoPIN'>, $amount, 'Switzerland', 
         'CHF', 'YYMMDD', 'Purchase', ~UN_360>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_48to50to51_Terminal_Sends_GPO_High_Visa:
   [
   StB( ~pid, 'tgk48', 'empty_tuple' ), Fr( ~UN_367 ),
   !Value_33( $amount, 'High' )
   ]
  --[ OneTerminal_243( ), Role_46( $Terminal, 'Terminal' ) ]->
   [
   StF( ~pid, 'tgk51',
        <
         <<'ARQC', 'OnlinePIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 
          'Purchase', ~UN_367>, 
         $Terminal>
   ),
   Out( <'GET_PROCESSING_OPTIONS', <'ARQC', 'OnlinePIN'>, $amount, 
         'Switzerland', 'CHF', 'YYMMDD', 'Purchase', ~UN_367>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_manyto51tomany_Terminal_Sends_ReadRecord_Visa:
   [
   StF( ~pid, 'tgk51',
        <
         <<acType_379, CVM_383>, $amount, country_378, currency_377, date_376, 
          type_374, ~UN_380>, 
         $Terminal>
   ),
   In( <AIP_387, 'AFL', <~PAN_381, expDate_375>, IAD_382, AC_388, CID_385, 
        ATC_386, CTQ_384>
   )
   ]
  --[ Compatible_CID_acType_244( CID_385, acType_379 ) ]->
   [
   StB( ~pid, 'tgk51',
        <AC_388, AIP_387, ATC_386, CID_385, CTQ_384, IAD_382, ~PAN_381, 
         <<acType_379, CVM_383>, $amount, country_378, currency_377, date_376, 
          type_374, ~UN_380>, 
         $Terminal, expDate_375>
   ),
   Out( <'READ_RECORD', 'AFL'> )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_51to52to54_Terminal_Receives_Records_EMV_Visa:
   [
   StB( ~pid, 'tgk51',
        <tgc_AC_0, <'EMV', u_tgany21_392>, tgc_ATC_0, 'ARQC', tgc_CTQ_0, 
         tgc_IAD_0, ~u_tgany22_391, tgc_PDOL_0, $Terminal, tgc_expDate_0>
   ),
   In( <~u_tgany22_391, tgc_expDate_0> ),
   !IssuingBank_64( ~u_tgany22_391, $Bank ),
   !CertBank_55( $Bank, <<'02', $Bank, pubkBank_390, $CA>, sign2_389> )
   ]
  -->
   [
   St( ~pid, 'tgk54',
       <tgc_AC_0, <'EMV', u_tgany21_392>, tgc_ATC_0, 'ARQC', tgc_CTQ_0, 
        tgc_IAD_0, ~u_tgany22_391, tgc_PDOL_0, $Terminal, $CA, $Bank, 
        pubkBank_390>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_51to53to54_Terminal_Receives_Records_DDA_Visa:
   [
   StB( ~pid, 'tgk51',
        <tgc_AC_0, <'DDA', u_tgany23_407>, tgc_ATC_0, tgc_CID_0, tgc_CTQ_0, 
         tgc_IAD_0, ~u_tgany24_406, 
         <TTQ_409, $amount, country_405, currency_404, date_403, type_394, ~UN_408
         >, 
         $Terminal, tgc_expDate_0>
   ),
   In( <~u_tgany24_406, tgc_expDate_0, $CA, 
        <<'02', $Bank, pubkBank_400, $CA>, sign2_396>, 
        <<'04', ~u_tgany24_406, pubkCard_398, $Bank>, sign3_395>, nc_401, 
        CTQ_411, SDAD_410>
   ),
   !IssuingCA_56( $Bank, $CA ), !SDADFormat_35( format_402, tgc_CID_0 ),
   !CertCA_48( $CA, <<'01', $CA, pubkCA_399, $CA>, sign1_397> )
   ]
  --[
  Eq_25( verify(sign1_397, <'01', $CA, pubkCA_399, $CA>, pubkCA_399), true
  ),
  Eq_25( verify(sign2_396, <'02', $Bank, pubkBank_400, $CA>, pubkCA_399),
         true
  ),
  Eq_25( verify(sign3_395, <'04', ~u_tgany24_406, pubkCard_398, $Bank>,
                pubkBank_400),
         true
  ),
  Eq_25( verify(SDAD_410,
                <format_402, tgc_ATC_0, ~UN_408, $amount, 'CHF', nc_401, tgc_CTQ_0, 
                 'DDA', u_tgany23_407>,
                pubkCard_398),
         true
  )
  ]->
   [
   St( ~pid, 'tgk54',
       <tgc_AC_0, <'DDA', u_tgany23_407>, tgc_ATC_0, tgc_CID_0, tgc_CTQ_0, 
        tgc_IAD_0, ~u_tgany24_406, 
        <TTQ_409, $amount, country_405, currency_404, date_403, type_394, ~UN_408
        >, 
        $Terminal, $CA, $Bank, pubkBank_400>
   )
   ]

  /*
  rule (modulo AC) Terminal_Visa_459_51to53to54_Terminal_Receives_Records_DDA_Visa:
     [
     StB( ~pid, 'tgk51',
          <tgc_AC_0, <'DDA', u_tgany23_407>, tgc_ATC_0, tgc_CID_0, tgc_CTQ_0, 
           tgc_IAD_0, ~u_tgany24_406, 
           <TTQ_409, $amount, country_405, currency_404, date_403, type_394, ~UN_408
           >, 
           $Terminal, tgc_expDate_0>
     ),
     In( <~u_tgany24_406, tgc_expDate_0, $CA, 
          <<'02', $Bank, pubkBank_400, $CA>, sign2_396>, 
          <<'04', ~u_tgany24_406, pubkCard_398, $Bank>, sign3_395>, nc_401, 
          CTQ_411, SDAD_410>
     ),
     !IssuingCA_56( $Bank, $CA ), !SDADFormat_35( format_402, tgc_CID_0 ),
     !CertCA_48( $CA, <<'01', $CA, pubkCA_399, $CA>, sign1_397> )
     ]
    --[
    Eq_25( z, true ), Eq_25( z.1, true ), Eq_25( z.2, true ),
    Eq_25( z.3, true )
    ]->
     [
     St( ~pid, 'tgk54',
         <tgc_AC_0, <'DDA', u_tgany23_407>, tgc_ATC_0, tgc_CID_0, tgc_CTQ_0, 
          tgc_IAD_0, ~u_tgany24_406, 
          <TTQ_409, $amount, country_405, currency_404, date_403, type_394, ~UN_408
          >, 
          $Terminal, $CA, $Bank, pubkBank_400>
     )
     ]
    variants (modulo AC)
     1. $Bank = $Bank.69
        $CA   = $CA.70
        $amount
              = $amount.72
        ~UN_408
              = ~UN_408.73
        ~u_tgany24_406
              = ~u_tgany24_406.75
        SDAD_410
              = SDAD_410.77
        format_402
              = format_402.82
        nc_401
              = nc_401.83
        pubkBank_400
              = pubkBank_400.84
        pubkCA_399
              = pubkCA_399.85
        pubkCard_398
              = pubkCard_398.86
        sign1_397
              = sign1_397.87
        sign2_396
              = sign2_396.88
        sign3_395
              = sign3_395.89
        tgc_ATC_0
              = tgc_ATC_0.91
        tgc_CTQ_0
              = tgc_CTQ_0.93
        u_tgany23_407
              = u_tgany23_407.97
        z     = verify(sign1_397.87, <'01', $CA.70, pubkCA_399.85, $CA.70>,
                       pubkCA_399.85)
        z.1   = verify(sign2_396.88, <'02', $Bank.69, pubkBank_400.84, $CA.70>,
                       pubkCA_399.85)
        z.2   = verify(sign3_395.89,
                       <'04', ~u_tgany24_406.75, pubkCard_398.86, $Bank.69>, pubkBank_400.84)
        z.3   = verify(SDAD_410.77,
                       <format_402.82, tgc_ATC_0.91, ~UN_408.73, $amount.72, 'CHF', nc_401.83, 
                        tgc_CTQ_0.93, 'DDA', u_tgany23_407.97>,
                       pubkCard_398.86)
    
     2. $Bank = $Bank.246
        $CA   = $CA.247
        $amount
              = $amount.249
        ~UN_408
              = ~UN_408.250
        ~u_tgany24_406
              = ~u_tgany24_406.252
        SDAD_410
              = sign(<format_402.259, tgc_ATC_0.268, ~UN_408.250, $amount.249, 'CHF', 
                      nc_401.260, tgc_CTQ_0.270, 'DDA', u_tgany23_407.274>,
                     x.490)
        format_402
              = format_402.259
        nc_401
              = nc_401.260
        pubkBank_400
              = pubkBank_400.261
        pubkCA_399
              = pubkCA_399.262
        pubkCard_398
              = pk(x.490)
        sign1_397
              = sign1_397.264
        sign2_396
              = sign2_396.265
        sign3_395
              = sign3_395.266
        tgc_ATC_0
              = tgc_ATC_0.268
        tgc_CTQ_0
              = tgc_CTQ_0.270
        u_tgany23_407
              = u_tgany23_407.274
        z     = verify(sign1_397.264, <'01', $CA.247, pubkCA_399.262, $CA.247>,
                       pubkCA_399.262)
        z.1   = verify(sign2_396.265,
                       <'02', $Bank.246, pubkBank_400.261, $CA.247>, pubkCA_399.262)
        z.2   = verify(sign3_395.266,
                       <'04', ~u_tgany24_406.252, pk(x.490), $Bank.246>, pubkBank_400.261)
        z.3   = true
    
     3. $Bank = $Bank.251
        $CA   = $CA.252
        $amount
              = $amount.254
        ~UN_408
              = ~UN_408.255
        ~u_tgany24_406
              = ~u_tgany24_406.257
        SDAD_410
              = SDAD_410.259
        format_402
              = format_402.264
        nc_401
              = nc_401.265
        pubkBank_400
              = pubkBank_400.266
        pubkCA_399
              = pk(x.500)
        pubkCard_398
              = pubkCard_398.268
        sign1_397
              = sign(<'01', $CA.252, pk(x.500), $CA.252>, x.500)
        sign2_396
              = sign2_396.270
        sign3_395
              = sign3_395.271
        tgc_ATC_0
              = tgc_ATC_0.273
        tgc_CTQ_0
              = tgc_CTQ_0.275
        u_tgany23_407
              = u_tgany23_407.279
        z     = true
        z.1   = verify(sign2_396.270,
                       <'02', $Bank.251, pubkBank_400.266, $CA.252>, pk(x.500))
        z.2   = verify(sign3_395.271,
                       <'04', ~u_tgany24_406.257, pubkCard_398.268, $Bank.251>,
                       pubkBank_400.266)
        z.3   = verify(SDAD_410.259,
                       <format_402.264, tgc_ATC_0.273, ~UN_408.255, $amount.254, 'CHF', 
                        nc_401.265, tgc_CTQ_0.275, 'DDA', u_tgany23_407.279>,
                       pubkCard_398.268)
    
     4. $Bank = $Bank.251
        $CA   = $CA.252
        $amount
              = $amount.254
        ~UN_408
              = ~UN_408.255
        ~u_tgany24_406
              = ~u_tgany24_406.257
        SDAD_410
              = SDAD_410.259
        format_402
              = format_402.264
        nc_401
              = nc_401.265
        pubkBank_400
              = pk(x.500)
        pubkCA_399
              = pubkCA_399.267
        pubkCard_398
              = pubkCard_398.268
        sign1_397
              = sign1_397.269
        sign2_396
              = sign2_396.270
        sign3_395
              = sign(<'04', ~u_tgany24_406.257, pubkCard_398.268, $Bank.251>, x.500)
        tgc_ATC_0
              = tgc_ATC_0.273
        tgc_CTQ_0
              = tgc_CTQ_0.275
        u_tgany23_407
              = u_tgany23_407.279
        z     = verify(sign1_397.269, <'01', $CA.252, pubkCA_399.267, $CA.252>,
                       pubkCA_399.267)
        z.1   = verify(sign2_396.270, <'02', $Bank.251, pk(x.500), $CA.252>,
                       pubkCA_399.267)
        z.2   = true
        z.3   = verify(SDAD_410.259,
                       <format_402.264, tgc_ATC_0.273, ~UN_408.255, $amount.254, 'CHF', 
                        nc_401.265, tgc_CTQ_0.275, 'DDA', u_tgany23_407.279>,
                       pubkCard_398.268)
    
     5. $Bank = $Bank.252
        $CA   = $CA.253
        $amount
              = $amount.255
        ~UN_408
              = ~UN_408.256
        ~u_tgany24_406
              = ~u_tgany24_406.258
        SDAD_410
              = SDAD_410.260
        format_402
              = format_402.265
        nc_401
              = nc_401.266
        pubkBank_400
              = pubkBank_400.267
        pubkCA_399
              = pk(x.502)
        pubkCard_398
              = pubkCard_398.269
        sign1_397
              = sign1_397.270
        sign2_396
              = sign(<'02', $Bank.252, pubkBank_400.267, $CA.253>, x.502)
        sign3_395
              = sign3_395.272
        tgc_ATC_0
              = tgc_ATC_0.274
        tgc_CTQ_0
              = tgc_CTQ_0.276
        u_tgany23_407
              = u_tgany23_407.280
        z     = verify(sign1_397.270, <'01', $CA.253, pk(x.502), $CA.253>,
                       pk(x.502))
        z.1   = true
        z.2   = verify(sign3_395.272,
                       <'04', ~u_tgany24_406.258, pubkCard_398.269, $Bank.252>,
                       pubkBank_400.267)
        z.3   = verify(SDAD_410.260,
                       <format_402.265, tgc_ATC_0.274, ~UN_408.256, $amount.255, 'CHF', 
                        nc_401.266, tgc_CTQ_0.276, 'DDA', u_tgany23_407.280>,
                       pubkCard_398.269)
    
     6. $Bank = $Bank.252
        $CA   = $CA.253
        $amount
              = $amount.255
        ~UN_408
              = ~UN_408.256
        ~u_tgany24_406
              = ~u_tgany24_406.258
        SDAD_410
              = SDAD_410.260
        format_402
              = format_402.265
        nc_401
              = nc_401.266
        pubkBank_400
              = pubkBank_400.267
        pubkCA_399
              = pk(x.502)
        pubkCard_398
              = pubkCard_398.269
        sign1_397
              = sign(<'01', $CA.253, pk(x.502), $CA.253>, x.502)
        sign2_396
              = sign(<'02', $Bank.252, pubkBank_400.267, $CA.253>, x.502)
        sign3_395
              = sign3_395.272
        tgc_ATC_0
              = tgc_ATC_0.274
        tgc_CTQ_0
              = tgc_CTQ_0.276
        u_tgany23_407
              = u_tgany23_407.280
        z     = true
        z.1   = true
        z.2   = verify(sign3_395.272,
                       <'04', ~u_tgany24_406.258, pubkCard_398.269, $Bank.252>,
                       pubkBank_400.267)
        z.3   = verify(SDAD_410.260,
                       <format_402.265, tgc_ATC_0.274, ~UN_408.256, $amount.255, 'CHF', 
                        nc_401.266, tgc_CTQ_0.276, 'DDA', u_tgany23_407.280>,
                       pubkCard_398.269)
    
     7. $Bank = $Bank.252
        $CA   = $CA.253
        $amount
              = $amount.255
        ~UN_408
              = ~UN_408.256
        ~u_tgany24_406
              = ~u_tgany24_406.258
        SDAD_410
              = SDAD_410.260
        format_402
              = format_402.265
        nc_401
              = nc_401.266
        pubkBank_400
              = pk(x.501)
        pubkCA_399
              = pk(x.502)
        pubkCard_398
              = pubkCard_398.269
        sign1_397
              = sign1_397.270
        sign2_396
              = sign(<'02', $Bank.252, pk(x.501), $CA.253>, x.502)
        sign3_395
              = sign(<'04', ~u_tgany24_406.258, pubkCard_398.269, $Bank.252>, x.501)
        tgc_ATC_0
              = tgc_ATC_0.274
        tgc_CTQ_0
              = tgc_CTQ_0.276
        u_tgany23_407
              = u_tgany23_407.280
        z     = verify(sign1_397.270, <'01', $CA.253, pk(x.502), $CA.253>,
                       pk(x.502))
        z.1   = true
        z.2   = true
        z.3   = verify(SDAD_410.260,
                       <format_402.265, tgc_ATC_0.274, ~UN_408.256, $amount.255, 'CHF', 
                        nc_401.266, tgc_CTQ_0.276, 'DDA', u_tgany23_407.280>,
                       pubkCard_398.269)
    
     8. $Bank = $Bank.252
        $CA   = $CA.253
        $amount
              = $amount.255
        ~UN_408
              = ~UN_408.256
        ~u_tgany24_406
              = ~u_tgany24_406.258
        SDAD_410
              = SDAD_410.260
        format_402
              = format_402.265
        nc_401
              = nc_401.266
        pubkBank_400
              = pk(x.501)
        pubkCA_399
              = pk(x.502)
        pubkCard_398
              = pubkCard_398.269
        sign1_397
              = sign(<'01', $CA.253, pk(x.502), $CA.253>, x.502)
        sign2_396
              = sign2_396.271
        sign3_395
              = sign(<'04', ~u_tgany24_406.258, pubkCard_398.269, $Bank.252>, x.501)
        tgc_ATC_0
              = tgc_ATC_0.274
        tgc_CTQ_0
              = tgc_CTQ_0.276
        u_tgany23_407
              = u_tgany23_407.280
        z     = true
        z.1   = verify(sign2_396.271, <'02', $Bank.252, pk(x.501), $CA.253>,
                       pk(x.502))
        z.2   = true
        z.3   = verify(SDAD_410.260,
                       <format_402.265, tgc_ATC_0.274, ~UN_408.256, $amount.255, 'CHF', 
                        nc_401.266, tgc_CTQ_0.276, 'DDA', u_tgany23_407.280>,
                       pubkCard_398.269)
    
     9. $Bank = $Bank.252
        $CA   = $CA.253
        $amount
              = $amount.255
        ~UN_408
              = ~UN_408.256
        ~u_tgany24_406
              = ~u_tgany24_406.258
        SDAD_410
              = SDAD_410.260
        format_402
              = format_402.265
        nc_401
              = nc_401.266
        pubkBank_400
              = pk(x.501)
        pubkCA_399
              = pk(x.502)
        pubkCard_398
              = pubkCard_398.269
        sign1_397
              = sign(<'01', $CA.253, pk(x.502), $CA.253>, x.502)
        sign2_396
              = sign(<'02', $Bank.252, pk(x.501), $CA.253>, x.502)
        sign3_395
              = sign(<'04', ~u_tgany24_406.258, pubkCard_398.269, $Bank.252>, x.501)
        tgc_ATC_0
              = tgc_ATC_0.274
        tgc_CTQ_0
              = tgc_CTQ_0.276
        u_tgany23_407
              = u_tgany23_407.280
        z     = true
        z.1   = true
        z.2   = true
        z.3   = verify(SDAD_410.260,
                       <format_402.265, tgc_ATC_0.274, ~UN_408.256, $amount.255, 'CHF', 
                        nc_401.266, tgc_CTQ_0.276, 'DDA', u_tgany23_407.280>,
                       pubkCard_398.269)
    
    10. $Bank = $Bank.254
        $CA   = $CA.255
        $amount
              = $amount.257
        ~UN_408
              = ~UN_408.258
        ~u_tgany24_406
              = ~u_tgany24_406.260
        SDAD_410
              = sign(<format_402.267, tgc_ATC_0.276, ~UN_408.258, $amount.257, 'CHF', 
                      nc_401.268, tgc_CTQ_0.278, 'DDA', u_tgany23_407.282>,
                     x.500)
        format_402
              = format_402.267
        nc_401
              = nc_401.268
        pubkBank_400
              = pubkBank_400.269
        pubkCA_399
              = pk(x.506)
        pubkCard_398
              = pk(x.500)
        sign1_397
              = sign(<'01', $CA.255, pk(x.506), $CA.255>, x.506)
        sign2_396
              = sign2_396.273
        sign3_395
              = sign3_395.274
        tgc_ATC_0
              = tgc_ATC_0.276
        tgc_CTQ_0
              = tgc_CTQ_0.278
        u_tgany23_407
              = u_tgany23_407.282
        z     = true
        z.1   = verify(sign2_396.273,
                       <'02', $Bank.254, pubkBank_400.269, $CA.255>, pk(x.506))
        z.2   = verify(sign3_395.274,
                       <'04', ~u_tgany24_406.260, pk(x.500), $Bank.254>, pubkBank_400.269)
        z.3   = true
    
    11. $Bank = $Bank.254
        $CA   = $CA.255
        $amount
              = $amount.257
        ~UN_408
              = ~UN_408.258
        ~u_tgany24_406
              = ~u_tgany24_406.260
        SDAD_410
              = sign(<format_402.267, tgc_ATC_0.276, ~UN_408.258, $amount.257, 'CHF', 
                      nc_401.268, tgc_CTQ_0.278, 'DDA', u_tgany23_407.282>,
                     x.501)
        format_402
              = format_402.267
        nc_401
              = nc_401.268
        pubkBank_400
              = pk(x.506)
        pubkCA_399
              = pubkCA_399.270
        pubkCard_398
              = pk(x.501)
        sign1_397
              = sign1_397.272
        sign2_396
              = sign2_396.273
        sign3_395
              = sign(<'04', ~u_tgany24_406.260, pk(x.501), $Bank.254>, x.506)
        tgc_ATC_0
              = tgc_ATC_0.276
        tgc_CTQ_0
              = tgc_CTQ_0.278
        u_tgany23_407
              = u_tgany23_407.282
        z     = verify(sign1_397.272, <'01', $CA.255, pubkCA_399.270, $CA.255>,
                       pubkCA_399.270)
        z.1   = verify(sign2_396.273, <'02', $Bank.254, pk(x.506), $CA.255>,
                       pubkCA_399.270)
        z.2   = true
        z.3   = true
    
    12. $Bank = $Bank.255
        $CA   = $CA.256
        $amount
              = $amount.258
        ~UN_408
              = ~UN_408.259
        ~u_tgany24_406
              = ~u_tgany24_406.261
        SDAD_410
              = sign(<format_402.268, tgc_ATC_0.277, ~UN_408.259, $amount.258, 'CHF', 
                      nc_401.269, tgc_CTQ_0.279, 'DDA', u_tgany23_407.283>,
                     x.502)
        format_402
              = format_402.268
        nc_401
              = nc_401.269
        pubkBank_400
              = pubkBank_400.270
        pubkCA_399
              = pk(x.508)
        pubkCard_398
              = pk(x.502)
        sign1_397
              = sign1_397.273
        sign2_396
              = sign(<'02', $Bank.255, pubkBank_400.270, $CA.256>, x.508)
        sign3_395
              = sign3_395.275
        tgc_ATC_0
              = tgc_ATC_0.277
        tgc_CTQ_0
              = tgc_CTQ_0.279
        u_tgany23_407
              = u_tgany23_407.283
        z     = verify(sign1_397.273, <'01', $CA.256, pk(x.508), $CA.256>,
                       pk(x.508))
        z.1   = true
        z.2   = verify(sign3_395.275,
                       <'04', ~u_tgany24_406.261, pk(x.502), $Bank.255>, pubkBank_400.270)
        z.3   = true
    
    13. $Bank = $Bank.255
        $CA   = $CA.256
        $amount
              = $amount.258
        ~UN_408
              = ~UN_408.259
        ~u_tgany24_406
              = ~u_tgany24_406.261
        SDAD_410
              = sign(<format_402.268, tgc_ATC_0.277, ~UN_408.259, $amount.258, 'CHF', 
                      nc_401.269, tgc_CTQ_0.279, 'DDA', u_tgany23_407.283>,
                     x.502)
        format_402
              = format_402.268
        nc_401
              = nc_401.269
        pubkBank_400
              = pubkBank_400.270
        pubkCA_399
              = pk(x.508)
        pubkCard_398
              = pk(x.502)
        sign1_397
              = sign(<'01', $CA.256, pk(x.508), $CA.256>, x.508)
        sign2_396
              = sign(<'02', $Bank.255, pubkBank_400.270, $CA.256>, x.508)
        sign3_395
              = sign3_395.275
        tgc_ATC_0
              = tgc_ATC_0.277
        tgc_CTQ_0
              = tgc_CTQ_0.279
        u_tgany23_407
              = u_tgany23_407.283
        z     = true
        z.1   = true
        z.2   = verify(sign3_395.275,
                       <'04', ~u_tgany24_406.261, pk(x.502), $Bank.255>, pubkBank_400.270)
        z.3   = true
    
    14. $Bank = $Bank.255
        $CA   = $CA.256
        $amount
              = $amount.258
        ~UN_408
              = ~UN_408.259
        ~u_tgany24_406
              = ~u_tgany24_406.261
        SDAD_410
              = sign(<format_402.268, tgc_ATC_0.277, ~UN_408.259, $amount.258, 'CHF', 
                      nc_401.269, tgc_CTQ_0.279, 'DDA', u_tgany23_407.283>,
                     x.502)
        format_402
              = format_402.268
        nc_401
              = nc_401.269
        pubkBank_400
              = pk(x.507)
        pubkCA_399
              = pk(x.508)
        pubkCard_398
              = pk(x.502)
        sign1_397
              = sign1_397.273
        sign2_396
              = sign(<'02', $Bank.255, pk(x.507), $CA.256>, x.508)
        sign3_395
              = sign(<'04', ~u_tgany24_406.261, pk(x.502), $Bank.255>, x.507)
        tgc_ATC_0
              = tgc_ATC_0.277
        tgc_CTQ_0
              = tgc_CTQ_0.279
        u_tgany23_407
              = u_tgany23_407.283
        z     = verify(sign1_397.273, <'01', $CA.256, pk(x.508), $CA.256>,
                       pk(x.508))
        z.1   = true
        z.2   = true
        z.3   = true
    
    15. $Bank = $Bank.255
        $CA   = $CA.256
        $amount
              = $amount.258
        ~UN_408
              = ~UN_408.259
        ~u_tgany24_406
              = ~u_tgany24_406.261
        SDAD_410
              = sign(<format_402.268, tgc_ATC_0.277, ~UN_408.259, $amount.258, 'CHF', 
                      nc_401.269, tgc_CTQ_0.279, 'DDA', u_tgany23_407.283>,
                     x.502)
        format_402
              = format_402.268
        nc_401
              = nc_401.269
        pubkBank_400
              = pk(x.507)
        pubkCA_399
              = pk(x.508)
        pubkCard_398
              = pk(x.502)
        sign1_397
              = sign(<'01', $CA.256, pk(x.508), $CA.256>, x.508)
        sign2_396
              = sign2_396.274
        sign3_395
              = sign(<'04', ~u_tgany24_406.261, pk(x.502), $Bank.255>, x.507)
        tgc_ATC_0
              = tgc_ATC_0.277
        tgc_CTQ_0
              = tgc_CTQ_0.279
        u_tgany23_407
              = u_tgany23_407.283
        z     = true
        z.1   = verify(sign2_396.274, <'02', $Bank.255, pk(x.507), $CA.256>,
                       pk(x.508))
        z.2   = true
        z.3   = true
    
    16. $Bank = $Bank.255
        $CA   = $CA.256
        $amount
              = $amount.258
        ~UN_408
              = ~UN_408.259
        ~u_tgany24_406
              = ~u_tgany24_406.261
        SDAD_410
              = sign(<format_402.268, tgc_ATC_0.277, ~UN_408.259, $amount.258, 'CHF', 
                      nc_401.269, tgc_CTQ_0.279, 'DDA', u_tgany23_407.283>,
                     x.502)
        format_402
              = format_402.268
        nc_401
              = nc_401.269
        pubkBank_400
              = pk(x.507)
        pubkCA_399
              = pk(x.508)
        pubkCard_398
              = pk(x.502)
        sign1_397
              = sign(<'01', $CA.256, pk(x.508), $CA.256>, x.508)
        sign2_396
              = sign(<'02', $Bank.255, pk(x.507), $CA.256>, x.508)
        sign3_395
              = sign(<'04', ~u_tgany24_406.261, pk(x.502), $Bank.255>, x.507)
        tgc_ATC_0
              = tgc_ATC_0.277
        tgc_CTQ_0
              = tgc_CTQ_0.279
        u_tgany23_407
              = u_tgany23_407.283
        z     = true
        z.1   = true
        z.2   = true
        z.3   = true
  */

rule (modulo E) Terminal_Visa_459_54to55to58_Terminal_Processes_CVM_NoPIN_Visa:
   [
   St( ~pid, 'tgk54',
       <tgc_AC_0, tgc_AIP_0, tgc_ATC_0, tgc_CID_0, 'NoPIN', tgc_IAD_0, 
        ~u_tgany19_418, 
        <TTQ_420, $amount, country_417, currency_416, date_415, type_414, ~UN_419
        >, 
        $Terminal, $CA, $Bank, tgc_pubkBank_0>
   ),
   !Value_33( $amount, 'Low' )
   ]
  -->
   [
   StF( ~pid, 'tgk58',
        <tgc_AC_0, tgc_AIP_0, tgc_ATC_0, tgc_CID_0, 'NoPIN', tgc_IAD_0, 
         ~u_tgany19_418, 
         <TTQ_420, $amount, country_417, currency_416, date_415, type_414, ~UN_419
         >, 
         $Terminal, $CA, $Bank, 'Null'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_54to56to58_Terminal_Processes_CVM_CDCVM_Visa:
   [
   St( ~pid, 'tgk54',
       <tgc_AC_0, tgc_AIP_0, tgc_ATC_0, 'ARQC', 'CDCVM', tgc_IAD_0, tgc_PAN_0, 
        tgc_PDOL_0, $Terminal, $CA, $Bank, tgc_pubkBank_0>
   )
   ]
  -->
   [
   StF( ~pid, 'tgk58',
        <tgc_AC_0, tgc_AIP_0, tgc_ATC_0, 'ARQC', 'CDCVM', tgc_IAD_0, tgc_PAN_0, 
         tgc_PDOL_0, $Terminal, $CA, $Bank, 'Null'>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_54to57to58_Terminal_Processes_CVM_OnlinePIN_Visa:
   [
   St( ~pid, 'tgk54',
       <tgc_AC_0, tgc_AIP_0, tgc_ATC_0, 'ARQC', 'OnlinePIN', tgc_IAD_0, 
        ~u_tgany20_425, 
        <TTQ_427, $amount, country_424, currency_423, date_422, type_421, ~UN_426
        >, 
        $Terminal, $CA, $Bank, tgc_pubkBank_0>
   ),
   !Entered_PIN_82( ~u_tgany20_425, PIN_428 ), !Value_33( $amount, 'High' )
   ]
  -->
   [
   StF( ~pid, 'tgk58',
        <tgc_AC_0, tgc_AIP_0, tgc_ATC_0, 'ARQC', 'OnlinePIN', tgc_IAD_0, 
         ~u_tgany20_425, 
         <TTQ_427, $amount, country_424, currency_423, date_422, type_421, ~UN_426
         >, 
         $Terminal, $CA, $Bank, aenc(PIN_428, tgc_pubkBank_0)>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa:
   [
   StF( ~pid, 'tgk58',
        <tgc_AC_0, tgc_AIP_0, tgc_ATC_0, tgc_CID_0, tgc_CVM_0, tgc_IAD_0, 
         ~u_tgany18_430, tgc_PDOL_0, $Terminal, $CA, $Bank, tgc_encPIN_0>
   ),
   Fr( ~channelID_429 )
   ]
  --[
  Running_90( $Terminal, $Bank,
              <'Terminal', 'Bank', ~u_tgany18_430, tgc_AIP_0, tgc_CVM_0, tgc_PDOL_0, 
               tgc_ATC_0, tgc_AC_0, tgc_IAD_0>
  )
  ]->
   [
   StB( ~pid, 'tgk58',
        <tgc_CID_0, ~u_tgany18_430, $Terminal, $Bank, $CA, ~channelID_429, 
         ~u_tgany18_430, tgc_AIP_0, tgc_CVM_0, tgc_PDOL_0, tgc_ATC_0, tgc_AC_0, 
         tgc_IAD_0>
   ),
   Send_30( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
            <
             <~u_tgany18_430, tgc_AIP_0, tgc_CVM_0, tgc_PDOL_0, tgc_ATC_0, tgc_AC_0, 
              tgc_IAD_0>, 
             tgc_encPIN_0>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_58to59_Terminal_Commits_TC_Visa:
   [
   StB( ~pid, 'tgk58',
        <'TC', ~u_tgany17_436, $Terminal, $Bank, $CA, tgc_channelID_0, 
         ~u_tgany17_436, <'EMV', u_furtherData_437>, CVM_441, 
         <TTQ_439, $amount, country_435, currency_434, date_433, type_432, ~UN_438
         >, 
         ATC_442, AC_443, IAD_440>
   ),
   !Value_33( $amount, 'Low' )
   ]
  --[
  TerminalAccepts_246( <~u_tgany17_436, <'EMV', u_furtherData_437>, 
                        CVM_441, 
                        <TTQ_439, $amount, country_435, currency_434, date_433, type_432, ~UN_438
                        >, 
                        ATC_442, AC_443, IAD_440>
  ),
  Commit_247( 'Terminal', ~u_tgany17_436,
              <'Card', 'Terminal', ~u_tgany17_436, <'EMV', u_furtherData_437>, 
               CVM_441, 
               <TTQ_439, $amount, country_435, currency_434, date_433, type_432, ~UN_438
               >, 
               ATC_442, AC_443, IAD_440>
  ),
  Honest_78( $CA ), Honest_78( $Bank ), Honest_78( $Terminal ),
  Honest_78( ~u_tgany17_436 )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Terminal_Visa_459_58to60_Terminal_Commits_ARQC_Visa:
   [
   StB( ~pid, 'tgk58',
        <'ARQC', tgc_PAN_0, $Terminal, $Bank, $CA, tgc_channelID_0, ~PAN_452, 
         <'EMV', u_furtherData_449>, CVM_454, 
         <TTQ_451, $amount, country_448, currency_447, date_446, type_445, ~UN_450
         >, 
         ATC_455, AC_457, IAD_453>
   ),
   !Value_33( $amount, 'Low' ),
   Recv_31( $Bank, $Terminal, <tgc_channelID_0, 'Visa', '2'>,
            <'ARC', ARPC_456>
   )
   ]
  --[
  TerminalAccepts_246( <~PAN_452, <'EMV', u_furtherData_449>, CVM_454, 
                        <TTQ_451, $amount, country_448, currency_447, date_446, type_445, ~UN_450
                        >, 
                        ATC_455, AC_457, IAD_453>
  ),
  Commit_247( 'Terminal', tgc_PAN_0,
              <'Card', 'Terminal', ~PAN_452, <'EMV', u_furtherData_449>, CVM_454, 
               <TTQ_451, $amount, country_448, currency_447, date_446, type_445, ~UN_450
               >, 
               ATC_455, AC_457, IAD_453>
  ),
  Commit_247( $Terminal, $Bank,
              <'Bank', 'Terminal', ~PAN_452, <'EMV', u_furtherData_449>, CVM_454, 
               <TTQ_451, $amount, country_448, currency_447, date_446, type_445, ~UN_450
               >, 
               ATC_455, AC_457, IAD_453>
  ),
  Honest_78( $CA ), Honest_78( $Bank ), Honest_78( $Terminal ),
  Honest_78( tgc_PAN_0 )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_503_61tomany:
   [ Fr( ~pid ) ] --> [ StB( ~pid, 'tgk61', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_503_61to63tomany_Bank_Receives_AC:
   [
   StB( ~pid, 'tgk61', 'empty_tuple' ),
   Recv_31( $Terminal, $Bank, <channelID_475, 'Mastercard', '1'>,
            <
             <~PAN_477, AIP_482, CVM_480, X_476, ATC_481, 
              MAC_27(f_26(~MK_478, ATC_481), <X_476, AIP_482, ATC_481, IAD_479>), 
              IAD_479>, 
             encPIN_474>
   ),
   !Shk_65( ~PAN_477, ~MK_478 ), !IssuingBank_64( ~PAN_477, $Bank )
   ]
  --[ Once_32( <~PAN_477, ATC_481, 'Bank'> ) ]->
   [
   StB( ~pid, 'tgk63',
        <$Bank, $Terminal, encPIN_474, ~PAN_477, AIP_482, CVM_480, X_476, 
         ATC_481, 
         MAC_27(f_26(~MK_478, ATC_481), <X_476, AIP_482, ATC_481, IAD_479>), 
         IAD_479>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_503_61to62_Bank_Receives_AC_Failed:
   [
   StB( ~pid, 'tgk61', 'empty_tuple' ),
   Recv_31( $Terminal, $Bank, <channelID_463, 'Mastercard', '1'>,
            <<~PAN_465, AIP_470, CVM_468, X_464, ATC_469, AC_471, IAD_467>, 
             encPIN_462>
   ),
   !Shk_65( ~PAN_465, ~MK_466 )
   ]
  --[
  NEq_24( MAC_27(f_26(~MK_466, ATC_469),
                 <X_464, AIP_470, ATC_469, IAD_467>),
          AC_471
  ),
  BankDeclines_460( <~PAN_465, AIP_470, CVM_468, X_464, ATC_469, AC_471, 
                     IAD_467>
  )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_503_63to64_Bank_Processes_CVM_NotOnlinePIN:
   [
   StB( ~pid, 'tgk63',
        <$Bank, $Terminal, 'Null', ~PAN_487, AIP_491, CVM_489, X_486, ATC_490, 
         AC_492, IAD_488>
   )
   ]
  --[
  NEq_24( CVM_489, 'OnlinePIN' ),
  Running_90( $Bank, $Terminal,
              <'Bank', 'Terminal', ~PAN_487, AIP_491, CVM_489, X_486, ATC_490, AC_492, 
               IAD_488>
  )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_503_63to65_Bank_Processes_CVM_OnlinePIN:
   [
   StB( ~pid, 'tgk63',
        <$Bank, $Terminal, aenc(PIN_496, pk(~privBank_494)), ~PAN_497, AIP_501, 
         'OnlinePIN', X_495, ATC_500, AC_502, IAD_499>
   ),
   !LtkBank_54( $Bank, ~privkBank_493 ), !PIN_83( ~PAN_497, PIN_496 ),
   !Shk_65( ~PAN_497, ~MK_498 )
   ]
  --[
  Running_90( $Bank, $Terminal,
              <'Bank', 'Terminal', ~PAN_497, AIP_501, 'OnlinePIN', X_495, ATC_500, 
               AC_502, IAD_499>
  )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Visa_565_66tomany:
   [ Fr( ~pid ) ] --> [ StB( ~pid, 'tgk66', 'empty_tuple' ) ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Visa_565_66to68tomany_Bank_Receives_AC_Visa:
   [
   StB( ~pid, 'tgk66', 'empty_tuple' ),
   Recv_31( $Terminal, $Bank, <channelID_518, 'Visa', '1'>,
            <
             <~PAN_520, AIP_525, CVM_523, PDOL_519, ATC_524, 
              MAC_27(f_26(~MK_521, ATC_524), <PDOL_519, AIP_525, ATC_524, IAD_522>), 
              IAD_522>, 
             encPIN_517>
   ),
   !Shk_65( ~PAN_520, ~MK_521 ), !IssuingBank_64( ~PAN_520, $Bank )
   ]
  --[ Once_32( <~PAN_520, ATC_524, 'Bank'> ) ]->
   [
   StB( ~pid, 'tgk68',
        <
         MAC_arpc_28(f_26(~MK_521, ATC_524),
                     (MAC_27(f_26(~MK_521, ATC_524), <PDOL_519, AIP_525, ATC_524, IAD_522>)⊕
                      p8_29('ARC'))), 
         $Bank, $Terminal, channelID_518, encPIN_517, ~PAN_520, AIP_525, CVM_523, 
         PDOL_519, ATC_524, 
         MAC_27(f_26(~MK_521, ATC_524), <PDOL_519, AIP_525, ATC_524, IAD_522>), 
         IAD_522>
   )
   ]

  // loop breaker: [1]
  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Visa_565_68to69to71_Bank_Processes_CVM_NotOnlinePIN_Visa:
   [
   StB( ~pid, 'tgk68',
        <tgc_ARPC_0, $Bank, $Terminal, tgc_channelID_0, 'Null', ~PAN_536, 
         AIP_540, CVM_538, 
         <TTQ_535, amount_533, country_532, currency_531, date_530, type_529, 
          UN_534>, 
         ATC_539, AC_541, IAD_537>
   )
   ]
  --[
  NEq_24( CVM_538, 'OnlinePIN' ),
  Running_90( $Bank, $Terminal,
              <'Bank', 'Terminal', ~PAN_536, AIP_540, CVM_538, 
               <TTQ_535, amount_533, country_532, currency_531, date_530, type_529, 
                UN_534>, 
               ATC_539, AC_541, IAD_537>
  )
  ]->
   [
   StF( ~pid, 'tgk71',
        <tgc_ARPC_0, $Bank, $Terminal, tgc_channelID_0, ~PAN_536, AIP_540, 
         CVM_538, 
         <TTQ_535, amount_533, country_532, currency_531, date_530, type_529, 
          UN_534>, 
         ATC_539, AC_541, IAD_537>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Visa_565_68to70to71_Bank_Processes_CVM_OnlinePIN_Visa:
   [
   StB( ~pid, 'tgk68',
        <tgc_ARPC_0, $Bank, $Terminal, tgc_channelID_0, 
         aenc(~PIN_544, pk(~privkBank_543)), ~PAN_546, AIP_549, 'OnlinePIN', 
         PDOL_545, ATC_548, AC_550, IAD_547>
   ),
   !LtkBank_54( $Bank, ~privkBank_543 ), !PIN_83( ~PAN_546, ~PIN_544 )
   ]
  --[
  Running_90( $Bank, $Terminal,
              <'Bank', 'Terminal', ~PAN_546, AIP_549, 'OnlinePIN', PDOL_545, ATC_548, 
               AC_550, IAD_547>
  )
  ]->
   [
   StF( ~pid, 'tgk71',
        <tgc_ARPC_0, $Bank, $Terminal, tgc_channelID_0, ~PAN_546, AIP_549, 
         'OnlinePIN', PDOL_545, ATC_548, AC_550, IAD_547>
   )
   ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa:
   [
   StB( ~pid, 'tgk66', 'empty_tuple' ),
   Recv_31( $Terminal, $Bank, <channelID_506, 'Visa', '1'>,
            <<~PAN_508, AIP_513, CVM_511, PDOL_507, ATC_512, AC_514, IAD_510>, 
             encPIN_505>
   ),
   !Shk_65( ~PAN_508, ~MK_509 )
   ]
  --[
  NEq_24( MAC_27(f_26(~MK_509, ATC_512),
                 <PDOL_507, AIP_513, ATC_512, IAD_510>),
          AC_514
  ),
  BankDeclines_460( <~PAN_508, AIP_513, CVM_511, PDOL_507, ATC_512, 
                     AC_514, IAD_510>
  )
  ]->
   [ ]

  /* has exactly the trivial AC variant */

rule (modulo E) Bank_Visa_565_manyto71_Bank_Commits_Visa:
   [
   StF( ~pid, 'tgk71',
        <tgc_ARPC_0, $Bank, $Terminal, tgc_channelID_0, ~PAN_559, 
         <'EMV', u_furtherData_556>, CVM_561, 
         <TTQ_558, amount_555, country_554, currency_553, date_552, type_551, 
          UN_557>, 
         ATC_562, AC_563, IAD_560>
   ),
   !Value_33( amount_555, 'Low' ), !IssuingCA_56( $Bank, $CA )
   ]
  --[
  Commit_247( $Bank, ~PAN_559,
              <'Card', 'Bank', ~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
               <TTQ_558, amount_555, country_554, currency_553, date_552, type_551, 
                UN_557>, 
               ATC_562, AC_563, IAD_560>
  ),
  Commit_247( $Bank, $Terminal,
              <'Terminal', 'Bank', ~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
               <TTQ_558, amount_555, country_554, currency_553, date_552, type_551, 
                UN_557>, 
               ATC_562, AC_563, IAD_560>
  ),
  Honest_78( $CA ), Honest_78( $Bank ), Honest_78( $Terminal ),
  Honest_78( ~PAN_559 )
  ]->
   [
   Send_30( $Bank, $Terminal, <tgc_channelID_0, 'Visa', '2'>,
            <'ARC', tgc_ARPC_0>
   )
   ]

  /* has exactly the trivial AC variant */

restriction equal:
  "∀ a_566 b_567 #i_568.
    (Eq_25( a_566, b_567 ) @ #i_568) ⇒ (a_566 = b_567)"
  // safety formula

restriction not_equal:
  "∀ a_570 #i_571. (NEq_24( a_570, a_570 ) @ #i_571) ⇒ (⊥)"
  // safety formula

restriction once:
  "∀ a_573 #i_574 #j_575.
    ((Once_32( a_573 ) @ #i_574) ∧ (Once_32( a_573 ) @ #j_575)) ⇒
    (#i_574 = #j_575)"
  // safety formula

restriction unique_role:
  "∀ A_577 r1_578 r2_579 #i_580 #j_581.
    ((Role_46( A_577, r1_578 ) @ #i_580) ∧
     (Role_46( A_577, r2_579 ) @ #j_581)) ⇒
    (r1_578 = r2_579)"
  // safety formula

restriction compatibility:
  "(∀ #i_583.
     (Compatible_CID_CVM_245( 'TC', 'OnlinePIN' ) @ #i_583) ⇒ (⊥)) ∧
   (∀ #i_584. (Compatible_CID_acType_244( 'TC', 'ARQC' ) @ #i_584) ⇒ (⊥))"
  // safety formula

lemma executable:
  exists-trace
  "∃ Bank_586 PAN_587 t_588 #i_589 #j_590 #k_591 #l_592.
    (((((((((#i_589 < #j_590) ∧
            (Running_90( PAN_587, 'Terminal', <'Card', 'Terminal', t_588>
             ) @ #i_589)) ∧
           (Commit_247( 'Terminal', PAN_587, <'Card', 'Terminal', t_588>
            ) @ #j_590)) ∧
          (#k_591 < #l_592)) ∧
         (Running_90( PAN_587, Bank_586, <'Card', 'Bank', t_588> ) @ #k_591)) ∧
        (Commit_247( Bank_586, PAN_587, <'Card', 'Bank', t_588> ) @ #l_592)) ∧
       (∀ #a_593 #b_594.
         ((OneCard_89( ) @ #a_593) ∧ (OneCard_89( ) @ #b_594)) ⇒
         (#a_593 = #b_594))) ∧
      (∀ #a_595 #b_596.
        ((OneTerminal_243( ) @ #a_595) ∧ (OneTerminal_243( ) @ #b_596)) ⇒
        (#a_595 = #b_596))) ∧
     (∀ A_597 B_598 r_599 #a_600 #b_601.
       ((Role_46( A_597, r_599 ) @ #a_600) ∧
        (Role_46( B_598, r_599 ) @ #b_601)) ⇒
       (A_597 = B_598))) ∧
    (¬(∃ A_602 #a_603. Compromise_63( A_602 ) @ #a_603))"
/*
guarded formula characterizing all satisfying traces:
"∃ Bank_586 PAN_587 t_588 #i_589 #j_590 #k_591 #l_592.
  (Running_90( PAN_587, 'Terminal', <'Card', 'Terminal', t_588>
   ) @ #i_589) ∧
  (Commit_247( 'Terminal', PAN_587, <'Card', 'Terminal', t_588>
   ) @ #j_590) ∧
  (Running_90( PAN_587, Bank_586, <'Card', 'Bank', t_588> ) @ #k_591) ∧
  (Commit_247( Bank_586, PAN_587, <'Card', 'Bank', t_588> ) @ #l_592)
 ∧
  (#i_589 < #j_590) ∧
  (#k_591 < #l_592) ∧
  (∀ #a_593 #b_594.
    (OneCard_89( ) @ #a_593) ∧ (OneCard_89( ) @ #b_594) ⇒ #a_593 = #b_594) ∧
  (∀ #a_595 #b_596.
    (OneTerminal_243( ) @ #a_595) ∧ (OneTerminal_243( ) @ #b_596)
   ⇒
    #a_595 = #b_596) ∧
  (∀ A_597 B_598 r_599 #a_600 #b_601.
    (Role_46( A_597, r_599 ) @ #a_600) ∧ (Role_46( B_598, r_599 ) @ #b_601)
   ⇒
    A_597 = B_598) ∧
  (∀ A_602 #a_603. (Compromise_63( A_602 ) @ #a_603) ⇒ ⊥)"
*/
by sorry

lemma bank_accepts:
  all-traces
  "∀ t_605 #i_606.
    (TerminalAccepts_246( t_605 ) @ #i_606) ⇒
    ((¬(∃ #j_607. BankDeclines_460( t_605 ) @ #j_607)) ∨
     (∃ A_608 #k_609.
       (Honest_78( A_608 ) @ #i_606) ∧ (Compromise_63( A_608 ) @ #k_609)))"
/*
guarded formula characterizing all counter-examples:
"∃ t_605 #i_606.
  (TerminalAccepts_246( t_605 ) @ #i_606)
 ∧
  (∃ #j_607. (BankDeclines_460( t_605 ) @ #j_607)) ∧
  (∀ A_608 #k_609.
    (Honest_78( A_608 ) @ #i_606) ∧ (Compromise_63( A_608 ) @ #k_609) ⇒ ⊥)"
*/
simplify
solve( TerminalAccepts_246( t_605 ) @ #i_606 )
  case Terminal_Visa_459_58to59_Terminal_Commits_TC_Visa
  by solve( StB( ~pid, 'tgk58',
                 <'TC', ~u_tgany17_436, $Terminal, $Bank, $CA, tgc_channelID_0, 
                  ~u_tgany17_436, <'EMV', u_furtherData_437>, CVM_441, 
                  <TTQ_439, $amount, country_435, currency_434, date_433, type_432, ~UN_438
                  >, 
                  ATC_442, AC_443, IAD_440>
            ) ▶₀ #i_606 )
next
  case Terminal_Visa_459_58to60_Terminal_Commits_ARQC_Visa
  solve( StB( ~pid, 'tgk58',
              <'ARQC', tgc_PAN_0, $Terminal, $Bank, $CA, tgc_channelID_0, ~PAN_452, 
               <'EMV', u_furtherData_449>, CVM_454, 
               <TTQ_451, $amount, country_448, currency_447, date_446, type_445, ~UN_450
               >, 
               ATC_455, AC_457, IAD_453>
         ) ▶₀ #i_606 )
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_01
    solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
      case Generate_Amount_Low_41
      solve( Recv_31( $Bank, $Terminal, <~channelID_429, 'Visa', '2'>,
                      <'ARC', ARPC_456>
             ) ▶₂ #i_606 )
        case Terminal_Bank_Network_40_case_1
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_122
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_2
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_122
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_3
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_122
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_4
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_122
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_02
    solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
      case Generate_Amount_Low_41
      solve( Recv_31( $Bank, $Terminal, <~channelID_429, 'Visa', '2'>,
                      <'ARC', ARPC_456>
             ) ▶₂ #i_606 )
        case Terminal_Bank_Network_40_case_1
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_Visa_180
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_4
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_2
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_Visa_180
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_4
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_3
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_Visa_180
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_4
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_4
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'NoPIN', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_Visa_180
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_4
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_03
    solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
      case Generate_Amount_Low_41
      solve( Recv_31( $Bank, $Terminal, <~channelID_429, 'Visa', '2'>,
                      <'ARC', ARPC_456>
             ) ▶₂ #i_606 )
        case Terminal_Bank_Network_40_case_1
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_122
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_2
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_122
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_3
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_122
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_4
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_122
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to18to21_Card_Responds_To_ReadRecord_NotDDA_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_168_17to19to20_Card_Responds_To_ReadRecord_DDA_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_113))>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_04
    by solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_05
    solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
      case Generate_Amount_Low_41
      solve( Recv_31( $Bank, $Terminal, <~channelID_429, 'Visa', '2'>,
                      <'ARC', ARPC_456>
             ) ▶₂ #i_606 )
        case Terminal_Bank_Network_40_case_1
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_Visa_180
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_4
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_2
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_Visa_180
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_4
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, CVM_561, 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      'Null'>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_3
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_Visa_180
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_4
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      next
        case Terminal_Bank_Network_40_case_4
        solve( BankDeclines_460( <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                  <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                   ~UN_450>, 
                                  ATC_455, AC_457, IAD_453>
               ) @ #j_607 )
          case Bank_503_61to62_Bank_Receives_AC_Failed
          solve( StB( ~pid.1, 'tgk61', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_503_61tomany
            by solve( Recv_31( $Terminal.1, $Bank.1,
                               <channelID_463, 'Mastercard', '1'>,
                               <
                                <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                                 <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                                  ~UN_450>, 
                                 ATC_455, AC_457, IAD_453>, 
                                encPIN_462>
                      ) ▶₁ #j_607 )
          qed
        next
          case Bank_Visa_565_66to67_Bank_Receives_AC_Failed_Visa
          solve( StB( ~pid.1, 'tgk66', 'empty_tuple' ) ▶₀ #j_607 )
            case Bank_Visa_565_66tomany
            solve( Recv_31( $Terminal.1, $Bank.1, <channelID_506, 'Visa', '1'>,
                            <
                             <~PAN_452, <'EMV', u_furtherData_449>, 'CDCVM', 
                              <<'TC', 'NoPIN'>, $amount, 'Switzerland', 'CHF', 'YYMMDD', 'Purchase', 
                               ~UN_450>, 
                              ATC_455, AC_457, IAD_453>, 
                             encPIN_505>
                   ) ▶₁ #j_607 )
              case Terminal_Bank_Network_40
              solve( !Shk_65( ~PAN_452, ~MK_509 ) ▶₂ #j_607 )
                case Create_Card_Visa_180
                solve( !KU( ~PAN_452 ) @ #vk.4 )
                  case Card_Visa_242_25to26to28_Card_Responds_To_GPO_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_25to27to28_Card_Responds_To_GPO_DDA_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to29_Card_Responds_To_ReadRecord_EMV_Visa
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_1
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_2
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_3
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Card_Visa_242_28to30_Card_Responds_To_ReadRecord_DDA_Visa_case_4
                  by solve( Recv_31( $Terminal, $Bank, <~channelID_429, 'Visa', '1'>,
                                     <
                                      <~PAN_559, <'EMV', u_furtherData_556>, 'OnlinePIN', 
                                       <TTQ_558, $amount.1, country_554, currency_553, date_552, type_551, 
                                        UN_557>, 
                                       ATC_562, 
                                       MAC_27(f_26(~MK_521, ATC_562),
                                              <
                                               <TTQ_558, $amount.1, country_554, currency_553, date_552, 
                                                type_551, UN_557>, 
                                               <'EMV', u_furtherData_556>, ATC_562, IAD_560>), 
                                       IAD_560>, 
                                      aenc(~PIN_544, pk(~privkBank_172))>
                            ) ▶₁ #vr.14 )
                next
                  case Compromise_Card_73
                  by contradiction /* from formulas */
                qed
              qed
            qed
          qed
        qed
      qed
    qed
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_06
    by solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_07
    by solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_08
    by solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_09
    by solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
  next
    case Terminal_Visa_459_manyto58tomany_Terminal_Sends_AC_Visa_case_10
    by solve( !Value_33( $amount, 'Low' ) ▶₁ #i_606 )
  qed
qed

lemma auth_to_terminal_minimal:
  all-traces
  "∀ T_611 P_612 r_613 t_614 #i_615.
    ((∀ #a_616 #b_617.
       ((OneCard_89( ) @ #a_616) ∧ (OneCard_89( ) @ #b_617)) ⇒
       (#a_616 = #b_617)) ∧
     (Commit_247( T_611, P_612, <r_613, 'Terminal', t_614> ) @ #i_615)) ⇒
    ((∃ #j_618.
       Running_90( P_612, T_611, <r_613, 'Terminal', t_614> ) @ #j_618) ∨
     (∃ A_619 #k_620.
       (Honest_78( A_619 ) @ #i_615) ∧ (Compromise_63( A_619 ) @ #k_620)))"
/*
guarded formula characterizing all counter-examples:
"∃ T_611 P_612 r_613 t_614 #i_615.
  (Commit_247( T_611, P_612, <r_613, 'Terminal', t_614> ) @ #i_615)
 ∧
  (∀ #a_616 #b_617.
    (OneCard_89( ) @ #a_616) ∧ (OneCard_89( ) @ #b_617) ⇒ #a_616 = #b_617) ∧
  (∀ #j_618.
    (Running_90( P_612, T_611, <r_613, 'Terminal', t_614> ) @ #j_618) ⇒ ⊥) ∧
  (∀ A_619 #k_620.
    (Honest_78( A_619 ) @ #i_615) ∧ (Compromise_63( A_619 ) @ #k_620) ⇒ ⊥)"
*/
by sorry

lemma auth_to_bank_minimal:
  all-traces
  "∀ B_622 P_623 r_624 t_625 #i_626.
    ((∀ #a_627 #b_628.
       ((OneCard_89( ) @ #a_627) ∧ (OneCard_89( ) @ #b_628)) ⇒
       (#a_627 = #b_628)) ∧
     (Commit_247( B_622, P_623, <r_624, 'Bank', t_625> ) @ #i_626)) ⇒
    ((∃ #j_629.
       Running_90( P_623, B_622, <r_624, 'Bank', t_625> ) @ #j_629) ∨
     (∃ A_630 #k_631.
       (Honest_78( A_630 ) @ #i_626) ∧ (Compromise_63( A_630 ) @ #k_631)))"
/*
guarded formula characterizing all counter-examples:
"∃ B_622 P_623 r_624 t_625 #i_626.
  (Commit_247( B_622, P_623, <r_624, 'Bank', t_625> ) @ #i_626)
 ∧
  (∀ #a_627 #b_628.
    (OneCard_89( ) @ #a_627) ∧ (OneCard_89( ) @ #b_628) ⇒ #a_627 = #b_628) ∧
  (∀ #j_629.
    (Running_90( P_623, B_622, <r_624, 'Bank', t_625> ) @ #j_629) ⇒ ⊥) ∧
  (∀ A_630 #k_631.
    (Honest_78( A_630 ) @ #i_626) ∧ (Compromise_63( A_630 ) @ #k_631) ⇒ ⊥)"
*/
by sorry

lemma secrecy_MK:
  all-traces
  "∀ MK_633 #i_634.
    (SecretMK_80( MK_633 ) @ #i_634) ⇒
    ((¬(∃ #j_635. !KU( MK_633 ) @ #j_635)) ∨
     (∃ A_636 #k_637.
       (Honest_78( A_636 ) @ #i_634) ∧ (Compromise_63( A_636 ) @ #k_637)))"
/*
guarded formula characterizing all counter-examples:
"∃ MK_633 #i_634.
  (SecretMK_80( MK_633 ) @ #i_634)
 ∧
  (∃ #j_635. (!KU( MK_633 ) @ #j_635)) ∧
  (∀ A_636 #k_637.
    (Honest_78( A_636 ) @ #i_634) ∧ (Compromise_63( A_636 ) @ #k_637) ⇒ ⊥)"
*/
by sorry

lemma secrecy_privkCard:
  all-traces
  "∀ privkCard_639 #i_640.
    (SecretPrivkCard_94( privkCard_639 ) @ #i_640) ⇒
    ((¬(∃ #j_641. !KU( privkCard_639 ) @ #j_641)) ∨
     (∃ A_642 #k_643.
       (Honest_78( A_642 ) @ #i_640) ∧ (Compromise_63( A_642 ) @ #k_643)))"
/*
guarded formula characterizing all counter-examples:
"∃ privkCard_639 #i_640.
  (SecretPrivkCard_94( privkCard_639 ) @ #i_640)
 ∧
  (∃ #j_641. (!KU( privkCard_639 ) @ #j_641)) ∧
  (∀ A_642 #k_643.
    (Honest_78( A_642 ) @ #i_640) ∧ (Compromise_63( A_642 ) @ #k_643) ⇒ ⊥)"
*/
by sorry

lemma secrecy_PIN:
  all-traces
  "∀ PIN_645 #i_646.
    (SecretPIN_77( PIN_645 ) @ #i_646) ⇒
    ((¬(∃ #j_647. !KU( PIN_645 ) @ #j_647)) ∨
     (∃ A_648 #k_649.
       (Honest_78( A_648 ) @ #i_646) ∧ (Compromise_63( A_648 ) @ #k_649)))"
/*
guarded formula characterizing all counter-examples:
"∃ PIN_645 #i_646.
  (SecretPIN_77( PIN_645 ) @ #i_646)
 ∧
  (∃ #j_647. (!KU( PIN_645 ) @ #j_647)) ∧
  (∀ A_648 #k_649.
    (Honest_78( A_648 ) @ #i_646) ∧ (Compromise_63( A_648 ) @ #k_649) ⇒ ⊥)"
*/
by sorry

lemma secrecy_PAN:
  all-traces
  "∀ PAN_651 #i_652.
    (SecretPAN_79( PAN_651 ) @ #i_652) ⇒
    ((¬(∃ #j_653. !KU( PAN_651 ) @ #j_653)) ∨
     (∃ A_654 #k_655.
       (Honest_78( A_654 ) @ #i_652) ∧ (Compromise_63( A_654 ) @ #k_655)))"
/*
guarded formula characterizing all counter-examples:
"∃ PAN_651 #i_652.
  (SecretPAN_79( PAN_651 ) @ #i_652)
 ∧
  (∃ #j_653. (!KU( PAN_651 ) @ #j_653)) ∧
  (∀ A_654 #k_655.
    (Honest_78( A_654 ) @ #i_652) ∧ (Compromise_63( A_654 ) @ #k_655) ⇒ ⊥)"
*/
by sorry

/* All well-formedness checks were successful. */

end